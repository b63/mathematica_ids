(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     89492,       2131]
NotebookOptionsPosition[     84853,       2053]
NotebookOutlinePosition[     85185,       2068]
CellTagsIndexPosition[     85142,       2065]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["IDS Functions", "Section",
 CellChangeTimes->{{3.844810332434315*^9, 
  3.844810359034068*^9}},ExpressionUUID->"4498e5ef-0615-419a-a4b1-\
d782d057b57e"],

Cell[CellGroupData[{

Cell["Functions for Link Management", "Subsection",
 CellChangeTimes->{{3.844810654989958*^9, 
  3.8448106660599623`*^9}},ExpressionUUID->"c4dfaf84-2c43-4350-a874-\
89f86c93ea28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Attempt", " ", "to", " ", "connect", " ", "to", " ", "WSTP", " ", 
    "listening", " ", "under", " ", 
    RowBox[{"name", " ", "'"}], 
    RowBox[{
     StyleBox[
      RowBox[{"ueye", 
       StyleBox["n",
        FontWeight->"Bold",
        FontSlant->"Italic"]}]], "'"}], " ", "\[IndentingNewLine]", 
    RowBox[{"Example", ":", " ", 
     RowBox[{"link", " ", 
      RowBox[{"named", " ", "'"}], 
      RowBox[{"ueye1", "'"}], " ", "should", " ", "be", " ", "waiting", " ", 
      "for", " ", "connection", " ", "if", " ", "n", " ", "is", " ", "1.", 
      "\[IndentingNewLine]", "Function", " ", "Aborts", " ", "if", " ", 
      "activation", " ", "does", " ", "not", " ", "occur", " ", "within", " ",
       "5", " ", 
      RowBox[{"seconds", "."}]}]}]}], " ", "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"EstablishLink", "[", "n_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"link", " ", "=", " ", 
         RowBox[{"LinkConnect", "[", 
          RowBox[{"\"\<ueye\>\"", "<>", 
           RowBox[{"ToString", "[", "n", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"TimeConstrained", "[", 
         RowBox[{
          RowBox[{"LinkActivate", "[", "link", "]"}], ",", "5"}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Closes", " ", "all", " ", "links", " ", "with", " ", "names", " ", 
     "that", " ", "start", " ", "with", " ", "ueye", "*", 
     RowBox[{".", "\[IndentingNewLine]", 
      RowBox[{"Note", ":", " ", 
       RowBox[{
       "ALWAYS", " ", "CLOSE", " ", "LINK", " ", "AFTER", " ", "ONE", " ", 
        "SIDE", " ", "CLOSES", " ", "THE", " ", 
        RowBox[{
         RowBox[{"LINK", "/", "AND"}], "/", "OR"}], " ", "CRASHES"}]}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CloseLink", "[", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"LinkClose", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"Links", "[", "\"\<ueye*\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Links", "[", "\"\<ueye*\>\"", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Set", " ", "some", " ", "parameter", " ", "in", " ", "the", " ", 
      "Camera"}], ",", " ", 
     RowBox[{
     "only", " ", "exposure", " ", "and", " ", "gain", " ", "supported", " ", 
      "atm"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SetCameraProperty", "::", "notsupp"}], " ", "=", " ", 
     "\"\<Property `1` not supported\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SetCameraProperty", "[", 
      RowBox[{"name_", ",", " ", "value_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<exposure\>\"", ",", " ", "\"\<gain\>\""}], "}"}], 
             ",", " ", "name"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"SetProperty", "::", "notsupp"}], ",", " ", "name"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Check", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"LinkWrite", "[", 
             RowBox[{"link", ",", " ", 
              RowBox[{"ReturnExpressionPacket", "[", 
               RowBox[{"{", 
                RowBox[{"name", ",", " ", "value"}], "}"}], "]"}]}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Abort", "[", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
         "]"}], " ", ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Crop", " ", "the", " ", "image", " ", "before", " ", "sending", " ", 
      "to", " ", "Mathematica"}], " ", "-", " ", 
     RowBox[{
     "Mathematica", " ", "lags", " ", "real", " ", "hard", " ", "if", " ", 
      "image", " ", "is", " ", "big"}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SetImageDimensions", "::", "notsupp"}], " ", "=", " ", 
     "\"\<Property `1` not supported\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SetImageDimensions", "[", 
      RowBox[{"width_", ",", " ", "height_", ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"{", 
         RowBox[{"TopLeft", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "w", ",", "h"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", " ", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "TopLeft", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"y", " ", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "TopLeft", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"w", " ", "=", " ", 
         RowBox[{"IntegerPart", "[", "width", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"h", " ", "=", " ", 
         RowBox[{"IntegerPart", "[", "height", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Check", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LinkWrite", "[", 
           RowBox[{"link", ",", " ", 
            RowBox[{"ReturnExpressionPacket", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<imgcrop\>\"", ",", " ", "x", ",", " ", "y", ",", " ", "w", 
               ",", " ", "h"}], "}"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Abort", "[", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Send", " ", "an", " ", "Image", " ", "to", " ", "be", " ", "displayed", 
      " ", "on", " ", "the", " ", "screen"}], ",", " ", 
     RowBox[{
     "aborts", " ", "if", " ", "something", " ", "goes", " ", "wrong"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SendImage", "::", "dim"}], " ", "=", " ", 
     "\"\<must be of pixel 2d array with 1 or 3 channels\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SendImage", "[", "image_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bytes", ",", "n", ",", "dim"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ImageQ", "[", "image", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"bytes", " ", "=", " ", 
           RowBox[{"ImageData", "[", 
            RowBox[{"image", ",", " ", "\"\<Byte\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"bytes", " ", "=", " ", "image"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"dim", " ", "=", " ", 
         RowBox[{"Dimensions", "@", "bytes"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"Length", "@", "dim"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", " ", 
            RowBox[{"bytes", "=", " ", 
             RowBox[{"ArrayReshape", "[", 
              RowBox[{"bytes", ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"dim", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"dim", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}]}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"bytes", "=", 
             RowBox[{"bytes", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", ";;", ",", 
                RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"n", " ", "\[Equal]", " ", "2"}], " ", "||", " ", 
           RowBox[{"n", " ", "\[Equal]", " ", "3"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Check", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"LinkWrite", "[", 
              RowBox[{"link", ",", " ", 
               RowBox[{"ReturnExpressionPacket", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<send\>\"", ",", " ", "bytes"}], "}"}], "]"}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Pause", "[", "0.5", "]"}]}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "pause", " ", "for", " ", "a", " ", "litle", " ", "bit"}], ",", 
              " ", 
              RowBox[{
              "immediately", " ", "reading", " ", "when", " ", "other", " ", 
               "program", " ", 
               RowBox[{"isn", "'"}], "t", " ", "ready", " ", "seems", " ", 
               "to", " ", "let", " ", "all", " ", "hell", " ", "break", " ", 
               "lose", " ", "and", " ", "kernel", " ", "needs", " ", "to", 
               " ", "be", " ", "restarted"}]}], " ", "*)"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Abort", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Message", "[", 
           RowBox[{"SendImage", "::", "dim"}], "]"}]}], "\[IndentingNewLine]",
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Attempts", " ", "to", " ", "get", " ", "the", " ", "image", " ", "from",
       " ", "the", " ", "Camera"}], ",", " ", 
     RowBox[{
     "aborts", " ", "if", " ", "an", " ", "error", " ", "occurs", " ", 
      "while", " ", "reading", " ", "from", " ", 
      RowBox[{"link", ".", "\[IndentingNewLine]", "If"}], " ", "no", " ", 
      "data", " ", "is", " ", "avaiable", " ", "withint", " ", "TimeOut"}], 
     ",", " ", 
     RowBox[{"returns", " ", 
      RowBox[{"None", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GetImage", "::", "writetimeout"}], "=", 
     "\"\<Timeout when trying to write to link\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GetImage", "::", "readtimeout"}], "=", 
     "\"\<Timeout when trying to read from link\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GetImage", "[", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"{", 
        RowBox[{"TimeOut", "\[Rule]", " ", "5"}], "}"}], "]"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rt", "=", "None"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Check", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"no", " ", "clue", " ", "by", " ", "TimeConstrained", " ", 
            RowBox[{"doesn", "'"}], "t", " ", "work", " ", "here"}], "..."}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TimeConstrained", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"LinkWrite", "[", 
             RowBox[{"link", ",", 
              RowBox[{"ReturnExpressionPacket", "[", 
               RowBox[{"{", "\"\<get\>\"", "}"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"OptionValue", "[", "TimeOut", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Message", "[", 
             RowBox[{"GetImage", "::", "writetimeout"}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Abort", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"LinkReadyQ", "[", 
           RowBox[{"link", ",", 
            RowBox[{"OptionValue", "[", "TimeOut", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rt", "=", 
            RowBox[{"Check", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"TimeConstrained", "[", 
               RowBox[{
                RowBox[{"LinkRead", "[", "link", "]"}], ",", 
                RowBox[{"OptionValue", "[", "TimeOut", "]"}], ",", 
                RowBox[{"Message", "[", 
                 RowBox[{"GetImage", "::", "readtimeout"}], "]"}]}], "]"}], 
              ",", "\[IndentingNewLine]", " ", 
              RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"bytes", "=", "rt"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"PrintTemporary", "[", 
              RowBox[{"\"\<converting \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"Dimensions", "@", "rt"}], "]"}], "<>", 
               "\"\< image ...\>\""}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Image", "[", 
            RowBox[{"rt", ",", " ", "\"\<Byte\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", "None"}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8447408747136593`*^9, 3.8447409776734333`*^9}, {
   3.844741067200389*^9, 3.844741240029139*^9}, {3.8447414278345137`*^9, 
   3.844741522388459*^9}, {3.8447415653796387`*^9, 3.844741768214747*^9}, {
   3.8447418279761744`*^9, 3.84474187721706*^9}, {3.844761828322052*^9, 
   3.844761859485458*^9}, {3.844810275150283*^9, 3.84481027966434*^9}, {
   3.8448127680821495`*^9, 3.8448127690321445`*^9}, {3.8448127997621365`*^9, 
   3.8448128297021475`*^9}, {3.844812870042143*^9, 3.84481287622215*^9}, {
   3.844813121137395*^9, 3.844813125637393*^9}, {3.844816482845657*^9, 
   3.844816522655655*^9}, {3.844817651066927*^9, 3.8448176549969397`*^9}, {
   3.8448191354462986`*^9, 3.8448193951962996`*^9}, 3.8448567357746363`*^9, {
   3.844856769564743*^9, 3.8448567785556498`*^9}, {3.844856869163273*^9, 
   3.844857102551201*^9}, {3.8449072414793425`*^9, 3.8449072453230767`*^9}, {
   3.844907302710535*^9, 3.8449074128042946`*^9}, {3.8455831370100517`*^9, 
   3.8455833708448067`*^9}, {3.845584662385571*^9, 3.8455846934034157`*^9}, {
   3.845669901144256*^9, 3.845669901521392*^9}, {3.8456699499023314`*^9, 
   3.8456699545965023`*^9}, {3.846202240195815*^9, 3.846202251752707*^9}, {
   3.84620235613721*^9, 3.846202376332158*^9}, {3.846202504905114*^9, 
   3.846202524489572*^9}, {3.846202574114134*^9, 3.846202660477922*^9}, {
   3.846202723735569*^9, 3.846202774617688*^9}, {3.846203027183979*^9, 
   3.8462030369114437`*^9}, {3.846203444121768*^9, 3.846203524989108*^9}, {
   3.846250939980759*^9, 3.846250942830125*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"b754dcd4-23db-4d47-9ec4-43e5e5b071df"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Phase Correction", "Section",
 CellChangeTimes->{{3.846203808769896*^9, 
  3.846203817022039*^9}},ExpressionUUID->"b16162da-563c-4a90-abc1-\
472c54479c57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"blaze", " ", "'"}], 
    RowBox[{"blocks", "'"}], " ", "of", " ", "the", " ", "image"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"BlazedMode", "[", 
      RowBox[{
      "rowt_", ",", " ", "colt_", ",", " ", "offset_", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"OptionsPattern", "[", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Width", "\[Rule]", " ", "500"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"Height", "\[Rule]", " ", "500"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Blocks", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"5", ",", " ", "5"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"BlazeAngle", "\[Rule]", " ", 
           RowBox[{"45", " ", "Degree"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"ReferenceBlock", " ", "\[Rule]", " ", "\"\<Center\>\""}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"UseImage", "\[Rule]", " ", "None"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Frequency", "\[Rule]", " ", 
           RowBox[{"1", "/", "10"}]}]}], "\[IndentingNewLine]", "}"}], 
        "]"}]}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Check", "[", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"Module", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"img", ",", " ", 
           RowBox[{"w", "=", 
            RowBox[{"OptionValue", "[", "Width", "]"}]}], ",", " ", 
           RowBox[{"h", "=", 
            RowBox[{"OptionValue", "[", "Height", "]"}]}], ",", "xr", ",", 
           "yr", ",", "\[IndentingNewLine]", " ", "nw", ",", " ", "nh", ",", 
           " ", 
           RowBox[{"angle", "=", 
            RowBox[{"OptionValue", "[", "BlazeAngle", "]"}]}], ",", "bw", ",",
            "bh", ",", " ", 
           RowBox[{"rb", "=", 
            RowBox[{"OptionValue", "[", "ReferenceBlock", "]"}]}], ",", "rxi",
            ",", " ", "ryi", ",", "rxr", ",", "ryr", ",", "rr", ",", "cr", 
           ",", 
           RowBox[{"frq", "=", 
            RowBox[{"OptionValue", "@", "Frequency"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"OptionValue", "@", "UseImage"}], " ", "===", "None"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"img", " ", "=", " ", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", " ", 
               RowBox[{"{", 
                RowBox[{"h", ",", " ", "w"}], "}"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"img", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ImageQ", "@", 
                 RowBox[{"OptionValue", "@", "UseImage"}]}], ",", 
                RowBox[{"ImageData", "@", 
                 RowBox[{"OptionValue", "@", "UseImage"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"OptionValue", "@", "UseImage"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"h", ",", "w"}], "}"}], "=", 
              RowBox[{"Dimensions", "@", "img"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ListQ", "@", 
             RowBox[{"OptionValue", "@", "Blocks"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"nw", ",", "nh"}], "}"}], "=", 
             RowBox[{"OptionValue", "@", "Blocks"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"nw", " ", "=", " ", 
              RowBox[{"OptionValue", "@", "Blocks"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"nh", "=", "nw"}], ";"}]}], "\[IndentingNewLine]", "]"}],
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"bw", ",", "bh"}], "}"}], "=", 
           RowBox[{"Floor", "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"w", "/", "nw"}], ",", " ", 
              RowBox[{"h", "/", "nh"}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"xr", "[", "i_", "]"}], ":=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"bw", "*", "i"}], "+", "1"}], ")"}], ";;", 
            RowBox[{"(", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[Equal]", 
                RowBox[{"nw", "-", "1"}]}], ",", "w", ",", 
               RowBox[{"bw", "*", 
                RowBox[{"(", 
                 RowBox[{"i", "+", "1"}], ")"}]}]}], "]"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"yr", "[", "i_", "]"}], ":=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"bh", "*", "i"}], "+", "1"}], ")"}], ";;", 
            RowBox[{"(", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[Equal]", 
                RowBox[{"nh", "-", "1"}]}], ",", "h", ",", 
               RowBox[{"bh", "*", 
                RowBox[{"(", 
                 RowBox[{"i", "+", "1"}], ")"}]}]}], "]"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"rb", " ", "=!=", " ", "None"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"ListQ", "@", "rb"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ryi", ",", "rxi"}], "}"}], "=", 
                RowBox[{"Floor", "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nh", "-", "1"}], ",", 
                    RowBox[{"nw", "-", "1"}]}], "}"}], "/", "2"}], ")"}]}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"ryi", ",", "rxi"}], "}"}], "=", "rb"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"rxr", "=", 
              RowBox[{"xr", "[", "rxi", "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"ryr", "=", 
              RowBox[{"yr", "[", "ryi", "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"img", "[", 
               RowBox[{"[", 
                RowBox[{"ryr", ",", "rxr"}], "]"}], "]"}], "=", 
              RowBox[{"LG`BlazeImage", "[", 
               RowBox[{
                RowBox[{"img", "[", 
                 RowBox[{"[", 
                  RowBox[{"ryr", ",", "rxr"}], "]"}], "]"}], ",", "angle", 
                ",", 
                RowBox[{"Raw", "\[Rule]", " ", "True"}], ",", " ", 
                RowBox[{"Frequency", "\[Rule]", " ", "frq"}], ",", " ", 
                RowBox[{"PhaseOffset", "\[Rule]", " ", "0"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rr", ",", "cr"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"yr", "@", "rowt"}], ",", 
             RowBox[{"xr", "@", "colt"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"img", "[", 
            RowBox[{"[", 
             RowBox[{"rr", ",", "cr"}], "]"}], "]"}], "=", 
           RowBox[{"LG`BlazeImage", "[", 
            RowBox[{
             RowBox[{"img", "[", 
              RowBox[{"[", 
               RowBox[{"rr", ",", "cr"}], "]"}], "]"}], ",", "angle", ",", 
             RowBox[{"Raw", "\[Rule]", " ", "True"}], ",", " ", 
             RowBox[{"Frequency", "\[Rule]", " ", "frq"}], ",", " ", 
             RowBox[{"PhaseOffset", "\[Rule]", " ", "offset"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Image", "[", "img", "]"}]}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Abort", "[", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "to", " ", "pick", " ", "a", " ", "pixel", " ", "as", " ", "the", " ", 
     "intensity", " ", "probe"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"pixelpos", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PixelChooser", "[", 
      RowBox[{"image_", ",", "x_", ",", "y_", ",", "scale_", ",", "hbs_"}], 
      "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Check", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Module", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "i", ",", "bx", ",", " ", "by", ",", "bxs", ",", "bys", ",", "w", 
           ",", "h", ",", "sx", ",", "ex", ",", "sy", ",", "ey", ",", "data", 
           ",", "subimg", ",", "subimgs", ",", "offsetxs", ",", "border", ",",
            "offsetys", ",", "offsetxe", ",", "offsetye", ",", "scaledsubimg",
            ",", "smallsubimg", ",", 
           RowBox[{"ch", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"data", "=", 
           RowBox[{"ImageData", "@", "image"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h", ",", "w"}], "}"}], "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Dimensions", "@", "data"}], ")"}], "[", 
            RowBox[{"[", 
             RowBox[{";;", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", 
              RowBox[{"Dimensions", "@", "data"}]}], ">", " ", "2"}], ",", 
            " ", 
            RowBox[{"ch", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Dimensions", "@", "data"}], ")"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"pixelpos", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"h", "+", "1", "-", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Floor", "[", "y", "]"}], "+", "1"}], ",", "1"}], 
                 "]"}], ",", "h"}], "]"}]}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Floor", "[", "x", "]"}], "+", "1"}], ",", "1"}], 
                "]"}], ",", "w"}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"by", ",", "bx"}], "}"}], "=", 
           RowBox[{"pixelpos", "-", "hbs"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"subimgs", "=", 
           RowBox[{"scale", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "*", "hbs"}], "+", "1"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"subimg", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ch", " ", ">", " ", "0"}], ",", " ", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", 
                RowBox[{"subimgs", ",", "subimgs", ",", " ", "ch"}], "}"}]}], 
              "]"}], ",", " ", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", 
                RowBox[{"subimgs", ",", "subimgs"}], "}"}]}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"sx", ",", "sy"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"bx", ",", "1"}], "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{"by", ",", "1"}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ex", ",", "ey"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"bx", "+", 
                RowBox[{"2", "*", "hbs"}]}], ",", "w"}], "]"}], ",", " ", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"by", "+", 
                RowBox[{"2", "*", "hbs"}]}], ",", "h"}], "]"}]}], "}"}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"smallsubimg", "=", 
           RowBox[{"ImageTake", "[", 
            RowBox[{"image", ",", 
             RowBox[{"{", 
              RowBox[{"sy", ",", "ey"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"sx", ",", "ex"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"scaledsubimg", "=", 
           RowBox[{"ImageResize", "[", 
            RowBox[{"smallsubimg", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Scaled", "[", "scale", "]"}], ",", 
               RowBox[{"Scaled", "[", "scale", "]"}]}], "}"}], ",", 
             RowBox[{"Resampling", "\[Rule]", " ", "\"\<Constant\>\""}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"offsetxs", ",", "offsetys"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"bx", " ", "<", " ", "1"}], ",", " ", 
               RowBox[{
                RowBox[{"scale", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "bx"}], "+", "1"}], ")"}]}], "+", "1"}], ",", 
               " ", "1"}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"by", "<", " ", "1"}], ",", " ", 
               RowBox[{
                RowBox[{"scale", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "by"}], "+", "1"}], ")"}]}], "+", "1"}], ",", 
               " ", "1"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"offsetxe", ",", "offsetye"}], "}"}], "=", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"bx", "+", 
                 RowBox[{"2", "*", "hbs"}]}], " ", ">", "w"}], ",", 
               RowBox[{"subimgs", "+", 
                RowBox[{"scale", "*", 
                 RowBox[{"(", " ", 
                  RowBox[{"w", "-", 
                   RowBox[{"(", 
                    RowBox[{"bx", "+", 
                    RowBox[{"2", "*", "hbs"}]}], " ", ")"}]}], ")"}]}]}], ",",
                " ", "subimgs"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"by", "+", 
                 RowBox[{"2", "*", "hbs"}]}], ">", "h"}], ",", " ", 
               RowBox[{"subimgs", "+", 
                RowBox[{"scale", "*", 
                 RowBox[{"(", 
                  RowBox[{"h", "-", 
                   RowBox[{"(", 
                    RowBox[{"by", "+", 
                    RowBox[{"2", "*", "hbs"}]}], ")"}]}], ")"}]}]}], ",", " ",
                "subimgs"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"subimg", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"offsetys", ";;", "offsetye"}], ",", 
              RowBox[{"offsetxs", ";;", "offsetxe"}], ",", ";;"}], "]"}], 
            "]"}], "=", 
           RowBox[{"ImageData", "@", "scaledsubimg"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"border", "=", 
           RowBox[{"scale", "*", 
            RowBox[{"(", 
             RowBox[{"hbs", "+", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Row", "[", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Show", "[", 
              RowBox[{"image", ",", " ", 
               RowBox[{"ImageSize", "\[Rule]", " ", 
                RowBox[{"UpTo", "[", "500", "]"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Spacer", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Show", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Image", "@", "subimg"}], ",", " ", 
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{"Red", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"border", ",", "border"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"border", "+", "scale"}], ",", "border"}], "}"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"border", "+", "scale"}], ",", 
                    RowBox[{"border", "+", "scale"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"border", ",", 
                    RowBox[{"border", "+", "scale"}]}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"border", ",", "border"}], "}"}]}], "}"}], "-", 
                    "scale"}], "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]",
               "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ManipulatePixelChooser", "[", "image_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pixelpos", "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Chosen pixel (row, col): \>\"", ",", 
          RowBox[{"Dynamic", "[", "pixelpos", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PixelChooser", "[", 
           RowBox[{"image", ",", 
            RowBox[{"p", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"p", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "7", ",", "10"}], " ", 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"p", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "  ", 
            "Locator"}], "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.846203847278474*^9, 3.8462041731525784`*^9}, {
   3.846204206864183*^9, 3.846204283456038*^9}, {3.846204711579959*^9, 
   3.846204778697218*^9}, {3.846204844357868*^9, 3.846204853942843*^9}, {
   3.846204895759777*^9, 3.846205071906126*^9}, {3.84620510747309*^9, 
   3.846205170742476*^9}, {3.846205225608426*^9, 3.8462052345869904`*^9}, {
   3.846205337389119*^9, 3.8462055956629353`*^9}, {3.8462056376374397`*^9, 
   3.8462056843382597`*^9}, {3.846205757834895*^9, 3.8462058980717983`*^9}, {
   3.846206028706538*^9, 3.846206045500497*^9}, {3.846206112438814*^9, 
   3.846206277654694*^9}, {3.846206338536892*^9, 3.846206415147732*^9}, {
   3.846206447034687*^9, 3.8462066762806883`*^9}, {3.8462067370062523`*^9, 
   3.846206742045526*^9}, {3.846206854572191*^9, 3.8462069150770063`*^9}, {
   3.8462070582952347`*^9, 3.846207099789996*^9}, {3.846207190069112*^9, 
   3.8462072017189903`*^9}, {3.846207315312108*^9, 3.846207316824291*^9}, {
   3.846207571423655*^9, 3.846207592098525*^9}, {3.846207623318281*^9, 
   3.846207634659614*^9}, {3.846208080683784*^9, 3.846208082474313*^9}, {
   3.846208239130163*^9, 3.846208251678808*^9}, {3.84624620371085*^9, 
   3.8462462204232206`*^9}, {3.846247905470014*^9, 3.8462479121701145`*^9}, {
   3.846247994746915*^9, 3.846247995930775*^9}, {3.8462488245535493`*^9, 
   3.8462488284092655`*^9}, {3.8462489885287647`*^9, 3.846249019159665*^9}, {
   3.846249079849233*^9, 3.8462491054786844`*^9}, {3.8462492338651648`*^9, 
   3.8462492463457365`*^9}, {3.8462498000293036`*^9, 3.846249805296658*^9}, {
   3.8462498389908514`*^9, 3.846249988469623*^9}, {3.8467331184400673`*^9, 
   3.846733128672881*^9}, {3.846733160829542*^9, 3.8467332827894583`*^9}, {
   3.8467333469384117`*^9, 3.8467335098855743`*^9}, 
   3.846733638990006*^9},ExpressionUUID->"ca61e84a-d11e-4ed6-be56-\
450c09accd1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Import/Parse Data", "Section",
 CellChangeTimes->{{3.846733616578072*^9, 
  3.846733635023389*^9}},ExpressionUUID->"cc2b96f4-0361-462a-a09f-\
990f2bbda4a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"row", "-", 
    RowBox[{"wise", " ", "index", " ", "to", " ", 
     RowBox[{"(", 
      RowBox[{"row", ",", " ", "col"}], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"itorc", "[", 
      RowBox[{"i_", ",", 
       RowBox[{"rows_:", "18"}], ",", " ", 
       RowBox[{"cols_:", "32"}]}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Floor", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "/", "cols"}], "]"}], "+", "1"}], 
       ",", " ", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], ",", " ", "cols"}], "]"}], "+", 
        "1"}]}], "}"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"row", ",", "col"}], ")"}], " ", "to", " ", "row", " ", "wise", 
     " ", "index"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rctoi", "[", 
      RowBox[{"row_", ",", "col_", ",", 
       RowBox[{"row_:", "18"}], ",", 
       RowBox[{"cols_:", "32"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"row", "*", "cols"}], " ", "+", " ", "col", " ", "+", " ", 
      "1"}]}], ";"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AddPhaseBlock", "[", 
      RowBox[{
      "rowt_", ",", " ", "colt_", ",", " ", "image_", ",", "offset_", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"OptionsPattern", "[", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Blocks", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"32", ",", " ", "18"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Raw", "\[Rule]", " ", "False"}]}], "\[IndentingNewLine]", 
         "}"}], "]"}]}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Check", "[", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"Module", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"img", ",", " ", "w", ",", "h", ",", "xr", ",", "yr", ",", 
           RowBox[{"raw", "=", 
            RowBox[{"OptionValue", "[", "Raw", "]"}]}], ",", 
           "\[IndentingNewLine]", " ", "nw", ",", " ", "nh", ",", "bw", ",", 
           "bh", ",", "rxi", ",", " ", "ryi", ",", "rxr", ",", "ryr", ",", 
           "rr", ",", "cr"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"raw", "=", 
           RowBox[{"!", 
            RowBox[{"ImageQ", "@", "image"}]}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"img", "=", 
           RowBox[{"If", "[", 
            RowBox[{"raw", ",", "image", ",", 
             RowBox[{"ImageData", "@", "image"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h", ",", "w"}], "}"}], "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Dimensions", "@", "img"}], ")"}], "[", 
            RowBox[{"[", 
             RowBox[{";;", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ListQ", "@", 
             RowBox[{"OptionValue", "@", "Blocks"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"nw", ",", "nh"}], "}"}], "=", 
             RowBox[{"OptionValue", "@", "Blocks"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"nw", " ", "=", " ", 
              RowBox[{"OptionValue", "@", "Blocks"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"nh", "=", "nw"}], ";"}]}], "\[IndentingNewLine]", "]"}],
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"bw", ",", "bh"}], "}"}], "=", 
           RowBox[{"Floor", "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"w", "/", "nw"}], ",", " ", 
              RowBox[{"h", "/", "nh"}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"xr", "[", "i_", "]"}], ":=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"bw", "*", "i"}], "+", "1"}], ")"}], ";;", 
            RowBox[{"(", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[Equal]", 
                RowBox[{"nw", "-", "1"}]}], ",", "w", ",", 
               RowBox[{"bw", "*", 
                RowBox[{"(", 
                 RowBox[{"i", "+", "1"}], ")"}]}]}], "]"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"yr", "[", "i_", "]"}], ":=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"bh", "*", "i"}], "+", "1"}], ")"}], ";;", 
            RowBox[{"(", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[Equal]", 
                RowBox[{"nh", "-", "1"}]}], ",", "h", ",", 
               RowBox[{"bh", "*", 
                RowBox[{"(", 
                 RowBox[{"i", "+", "1"}], ")"}]}]}], "]"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rr", ",", "cr"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"yr", "@", "rowt"}], ",", 
             RowBox[{"xr", "@", "colt"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"img", "[", 
            RowBox[{"[", 
             RowBox[{"rr", ",", "cr"}], "]"}], "]"}], "=", " ", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"img", "[", 
               RowBox[{"[", 
                RowBox[{"rr", ",", "cr"}], "]"}], "]"}], "+", "offset"}], ",",
              "1.0"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"raw", ",", " ", "img", ",", 
            RowBox[{"Image", "[", "img", "]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Abort", "[", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LoadAberrationData", "[", 
      RowBox[{"path_", ",", " ", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"{", 
         RowBox[{"Blocks", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"32", ",", "18"}], "}"}]}], "}"}], "]"}]}], "]"}], ":=", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nw", ",", "nh"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ListQ", "@", 
           RowBox[{"OptionValue", "@", "Blocks"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"nw", ",", "nh"}], "}"}], "=", 
           RowBox[{"OptionValue", "@", "Blocks"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"nw", " ", "=", " ", 
            RowBox[{"OptionValue", "@", "Blocks"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nh", "=", "nw"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"TABLE", "=", 
         RowBox[{"Check", "[", 
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{"path", ",", " ", "\"\<Table\>\""}], "]"}], ",", " ", 
           RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ParseAberrationData", "[", 
      RowBox[{"step_:", "0.05"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"list", " ", "of", " ", 
         RowBox[{"(", 
          RowBox[{"phase", ",", " ", "value"}], ")"}], " ", "pairs", " ", 
         "for", " ", "plotting"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PHASES", " ", "=", " ", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "3"}], ")"}], "*", "step"}], ",", " ", 
               RowBox[{"TABLE", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", "3", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"TABLE", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "@", "TABLE"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"PHASESMAX", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"step", "*", 
            RowBox[{"TABLE", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "@", "TABLE"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PlotAberrationAll", "[", 
      RowBox[{"phases_", ",", " ", "table_", ",", 
       RowBox[{"step_:", "0.05"}], ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"{", 
         RowBox[{"Columns", "\[Rule]", " ", "3"}], "}"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"maxi", ",", "plots", ",", "p", ",", "n"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PrintTemporary", "[", 
         RowBox[{"\"\<Generating \[Phi] = \>\"", ",", " ", 
          RowBox[{"Dynamic", "[", "p", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"plots", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"maxi", "=", 
             RowBox[{"table", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"p", " ", "=", " ", 
             RowBox[{"i", "*", "step"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"ListLinePlot", "[", 
             RowBox[{
              RowBox[{"phases", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotLabel", "\[Rule]", 
               RowBox[{"ToString", "[", 
                RowBox[{"itorc", "[", "i", "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AxesLabel", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                "\"\<Phase ([0,1])\>\"", ",", " ", "\"\<Grayscale \>\""}], 
                "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Epilog", "\[Rule]", " ", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"Red", ",", "\[IndentingNewLine]", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"maxi", "*", "step"}], ",", " ", "0"}], "}"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"maxi", "*", "step"}], ",", " ", 
                    RowBox[{"table", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"maxi", "+", "3"}]}], "]"}], "]"}]}], "}"}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "]"}]}], 
           ",", " ", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "@", "phases"}], ",", "1"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"Length", "@", "phases"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Grid", "[", 
         RowBox[{"ArrayReshape", "[", 
          RowBox[{"plots", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Floor", "[", 
              RowBox[{"n", "/", 
               RowBox[{"OptionValue", "[", "Columns", "]"}]}], "]"}], ",", 
             RowBox[{"OptionValue", "[", "Columns", "]"}]}], "}"}]}], "]"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GenerateMask", "[", 
      RowBox[{"flatPhaseMask_", ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Width", "\[Rule]", " ", "1920"}], ",", " ", 
          RowBox[{"Height", "\[Rule]", " ", "1080"}], ",", " ", 
          RowBox[{"Raw", "\[Rule]", " ", "False"}]}], "}"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"w", "=", 
          RowBox[{"OptionValue", "[", "Width", "]"}]}], ",", " ", 
         RowBox[{"h", "=", 
          RowBox[{"OptionValue", "[", "Height", "]"}]}], ",", "imgv", ",", 
         "prog", ",", "i", ",", "pos"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"imgv", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"h", ",", "w"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PrintTemporary", "[", 
         RowBox[{"\"\<Generating \>\"", ",", " ", 
          RowBox[{"Dynamic", "[", "prog", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", " ", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "flatPhaseMask", "]"}]}], ",", " ", 
          RowBox[{"i", "+=", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pos", "=", 
            RowBox[{"itorc", "[", "i", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"prog", "=", 
            RowBox[{
             RowBox[{"ToString", "[", "i", "]"}], " ", "<>", "\"\< \>\"", "<>", 
             RowBox[{"ToString", "[", "pos", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"imgv", "=", 
            RowBox[{"AddPhaseBlock", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pos", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", 
              RowBox[{
               RowBox[{"pos", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", "1"}], ",", "imgv", ",", 
              " ", 
              RowBox[{"flatPhaseMask", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
              RowBox[{"Raw", "\[Rule]", " ", "True"}]}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Raw", "]"}], ",", " ", "imgv", ",", 
          " ", 
          RowBox[{"Image", "[", "imgv", "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AddMask", "[", 
      RowBox[{"img1_", ",", "img2_", ",", " ", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"{", 
         RowBox[{"Raw", "\[Rule]", " ", "False"}], "}"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i1", ",", "i2", ",", "i3"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ImageQ", "@", "img1"}], ",", " ", 
          RowBox[{"i1", "=", 
           RowBox[{"ImageData", "[", "img1", "]"}]}], ",", " ", 
          RowBox[{"i1", "=", "img1"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ImageQ", "@", "img2"}], ",", " ", 
          RowBox[{"i2", "=", 
           RowBox[{"ImageData", "[", "img2", "]"}]}], ",", " ", 
          RowBox[{"i2", "=", "img2"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"Dimensions", "@", "i1"}]}], "\[NotEqual]", " ", "2"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"i1", "=", 
            RowBox[{"ImageData", "@", 
             RowBox[{"ColorConvert", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"ImageQ", "@", "img1"}], ",", " ", "img1", ",", " ", 
                 
                 RowBox[{"Image", "[", "img1", "]"}]}], "]"}], ",", " ", 
               "\"\<Grayscale\>\""}], "]"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"Dimensions", "@", "i2"}]}], "\[NotEqual]", " ", "2"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"i2", "=", 
            RowBox[{"ImageData", "@", 
             RowBox[{"ColorConvert", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"ImageQ", "@", "img2"}], ",", " ", "img2", ",", " ", 
                 
                 RowBox[{"Image", "[", "img2", "]"}]}], "]"}], ",", " ", 
               "\"\<Grayscale\>\""}], "]"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"i3", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"i1", "+", "i2"}], ",", "1.0"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Raw", "]"}], ",", " ", "i3", ",", " ", 
          
          RowBox[{"Image", "[", "i3", "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQ3df84jX/yjeOHjEsb0B0xaFpH0C0+ZYb30E002W3
SBkgbZHq0ACiL1xXaAHRB4/WdoDoiL/NPSB61bV3E0H0keYju0D03/0Jx0G0
kvHm0yD6zvXOGyDaacpvBTkgvTBtgzaIbjpWagCiLSZb24FoQ3E2NxCdavrT
B0R3FOwIBtGnNhZGgmg3qfJEED1F0jkNRPP39OSA6D9PLTpB9IY1Hb0g+tyl
I2BarGvLNBBdOuHpLBCdtfvRPBA9Z6PkQhD9TyBwLYiWTlHcAFZ/duNuEJ35
+Pk+EC3AKHoKRPOE2oJpp0Ofz4HoTTdkH4Loe1FnPoLoJ0ulPoFol9kfvoLo
lv7abyA6Jd3iN4gO+1TLIA+k55keYQXRX20/ioBoAMBlxm0=
  "],
 CellLabel->
  "In[215]:=",ExpressionUUID->"a52f47e8-1e79-4921-b0e6-9f2200a6d2fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Program", "Section",
 CellChangeTimes->{{3.844812067143608*^9, 
  3.8448120691335983`*^9}},ExpressionUUID->"14fe7b53-3818-4c4b-a89c-\
7e6a9f07834d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"*", " ", 
   RowBox[{"EstablishLink", "[", "0", "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"start", " ", "link"}], ",", " ", 
     RowBox[{"make", " ", "sure", " ", "ueye_link", " ", 
      RowBox[{"is", " ", "'"}], "waiting", " ", "for", " ", 
      RowBox[{"connection", "'"}]}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8448120743536024`*^9, 3.8448120788936095`*^9}, {
   3.844812747042141*^9, 3.8448127479521427`*^9}, {3.844813029742141*^9, 
   3.844813030422144*^9}, {3.8448163574657917`*^9, 3.844816358055791*^9}, {
   3.8448194345662947`*^9, 3.844819458166295*^9}, {3.8448571425476294`*^9, 
   3.8448571426432943`*^9}, {3.845583108261401*^9, 3.845583108450591*^9}, {
   3.845584551266966*^9, 3.845584552577474*^9}, 3.8456700732748957`*^9, {
   3.845670156211924*^9, 3.845670156390291*^9}, {3.845818730480789*^9, 
   3.845818732348241*^9}},ExpressionUUID->"1e6df731-359c-4c01-aa6a-\
e0a4d67cdb5e"],

Cell[BoxData[
 RowBox[{"EstablishLink", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.846201278840493*^9, 3.846201281284244*^9}, {
  3.8462020537536507`*^9, 3.8462020540103607`*^9}, {3.846202286468583*^9, 
  3.846202286598235*^9}, {3.846202665787912*^9, 3.846202665867302*^9}, {
  3.8462031240393476`*^9, 3.846203124195291*^9}, {3.846203574666224*^9, 
  3.8462035748753977`*^9}, {3.8462462400395155`*^9, 3.84624624009951*^9}, {
  3.8462494465012207`*^9, 3.8462494465913744`*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"ed5242f1-b95a-47c3-ae4a-8264be5686d4"],

Cell[BoxData[
 RowBox[{"CloseLink", "[", "]"}]], "Input",
 CellChangeTimes->{{3.8462466205553136`*^9, 3.8462466228868527`*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"2c98b153-1fb0-4069-817c-4b01c437dcbe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "\"\</home/bk/opt/ldata/edu/guoy_phase/laguerre/LG.wl\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrintTemporary", "[", "\"\<loaded package.\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StartLG", "[", 
   RowBox[{
   "\"\</home/bk/opt/ldata/edu/guoy_phase/laguerre\>\"", ",", " ", 
    "\"\<bin/lg\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8467602143967*^9, 3.846760280899468*^9}, {
  3.846760313678322*^9, 3.84676032270998*^9}, {3.8467605530402117`*^9, 
  3.846760576290605*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"3c79b155-deb1-4c5f-bd6b-d5cb74ecde81"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "<<", "\"\<C:\\\\Users\\\\Physics \
Student\\\\Documents\\\\mathematica_laguerre\\\\Lg.wl\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "StartLG", "[", 
   "\"\<C:\\\\Users\\\\Physics Student\\\\Documents\\\\mathematica_laguerre\>\
\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.845669509841515*^9, 3.8456695261433907`*^9}, {
  3.845670049359408*^9, 3.8456700530160418`*^9}, {3.845818149671233*^9, 
  3.8458182101458073`*^9}, {3.8462067053223333`*^9, 3.846206708544455*^9}, {
  3.846246130905238*^9, 3.8462461386608753`*^9}, {3.8467602606026497`*^9, 
  3.846760260743113*^9}},ExpressionUUID->"c37999df-1cfb-48c6-8e66-\
bb91749427c0"],

Cell[BoxData[
 RowBox[{"LoadAberrationData", "[", 
  "\"\</home/bk/opt/ldata/edu/guoy_phase/aberration_data.dat\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.846206751047542*^9, 3.846206784676424*^9}, {
   3.8462461470030785`*^9, 3.846246154934105*^9}, 3.8467602599119167`*^9, {
   3.846762613345154*^9, 3.8467626690603848`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"c9961828-1154-4656-8d06-77ca425a6fda"],

Cell[BoxData[
 RowBox[{"ParseAberrationData", "[", "]"}]], "Input",
 CellChangeTimes->{{3.846762700922885*^9, 3.846762715758213*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"1012af6c-994c-4089-bc68-3f564c561e8f"],

Cell[BoxData[
 RowBox[{"lg", "=", 
  RowBox[{"LGMag", "[", 
   RowBox[{"1", ",", "0", ",", " ", 
    RowBox[{"ScalingFactor", "\[Rule]", " ", "0.1"}], ",", " ", 
    RowBox[{"Width", "\[Rule]", " ", "1920"}], ",", " ", 
    RowBox[{"Height", "\[Rule]", " ", "1080"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.846764302722698*^9, 3.846764391604946*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"758482e8-4b4d-428a-82ef-3fad19fb3091"],

Cell[BoxData[
 RowBox[{"AddMask", "[", 
  RowBox[{"lg", ",", " ", "img"}], "]"}]], "Input",
 CellChangeTimes->{{3.8467643965289383`*^9, 3.846764400634416*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"dc8a95ce-7526-4f34-a2c7-8f859397264e"],

Cell[BoxData[
 RowBox[{"img", "=", 
  RowBox[{"GenerateMask", "[", 
   RowBox[{"PHASESMAX", ",", 
    RowBox[{"Raw", "\[Rule]", " ", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.846763597976193*^9, 3.8467636153219357`*^9}, {
  3.846763754989677*^9, 3.846763756838279*^9}, {3.846763830240034*^9, 
  3.8467638308744164`*^9}, {3.846763867692471*^9, 3.846763868111236*^9}, {
  3.846764145484324*^9, 3.8467641468798027`*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"6f234b90-b3b1-49e6-a02b-aa51e2bb663c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"blank", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"1080", ",", "1920"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SendImage", "[", "blank", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.846246399130534*^9, 3.846246422758869*^9}, {
  3.846246913528238*^9, 3.8462469139600525`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"03136c75-adcf-4771-bd1a-db87122899a8"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.846246881048123*^9, 3.846246881052112*^9}, {
  3.846246925319688*^9, 
  3.846246927831933*^9}},ExpressionUUID->"7f255c3a-9bc1-4866-aad4-\
fd2e85b48626"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"prog", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", "prog", "]"}]}], "Input",
 CellChangeTimes->{{3.846247576058139*^9, 3.8462475821508665`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"fdbbadfe-7e6b-4033-8dd9-d145914da6f1"],

Cell[BoxData[
 DynamicBox[ToBoxes[$CellContext`prog, StandardForm],
  ImageSizeCache->{34., {3., 7.}}]], "Output",
 CellChangeTimes->{3.8462475828101015`*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"be578372-0d25-4d16-9c9d-856e7eb76efc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BlazedMode", "[", 
  RowBox[{"17", ",", "10", ",", "0", ",", 
   RowBox[{"BlazeAngle", "\[Rule]", " ", 
    RowBox[{"45", "Degree"}]}], ",", " ", 
   RowBox[{"Width", "\[Rule]", " ", "1920"}], ",", " ", 
   RowBox[{"Height", "\[Rule]", " ", "1080"}], ",", 
   RowBox[{"Blocks", "\[Rule]", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"16", ",", "9"}], "}"}], "*", "2"}]}], ",", " ", 
   RowBox[{"Frequency", "\[Rule]", " ", 
    RowBox[{"1", "/", "10"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8462486966127768`*^9, 3.846248750035951*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"cb01f7c2-c90f-4247-b2ea-ced8713e2770"],

Cell[BoxData[
 RowBox[{"BlazedMode", "[", 
  RowBox[{"17", ",", "10", ",", "0", ",", 
   RowBox[{"BlazeAngle", "\[Rule]", 
    RowBox[{"45", " ", "\[Degree]"}]}], ",", 
   RowBox[{"Width", "\[Rule]", "1920"}], ",", 
   RowBox[{"Height", "\[Rule]", "1080"}], ",", 
   RowBox[{"Blocks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"32", ",", "18"}], "}"}]}], ",", 
   RowBox[{"Frequency", "\[Rule]", 
    FractionBox["1", "10"]}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.846760367932961*^9, {3.846762542590246*^9, 3.846762554243067*^9}},
 CellLabel->"Out[11]=",ExpressionUUID->"695389bf-c743-45cc-9c9c-83a32e6faaa1"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8462492587066593`*^9, 
  3.84624925871364*^9}},ExpressionUUID->"0c90c4a1-718c-446e-bc11-\
7bed10fd86f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TestBlazeBlock", "[", 
    RowBox[{"row_", ",", "col_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"blimg", ",", "cimg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"blimg", "=", 
       RowBox[{"BlazedMode", "[", 
        RowBox[{"row", ",", "col", ",", "0", ",", 
         RowBox[{"BlazeAngle", "\[Rule]", " ", 
          RowBox[{"45", "Degree"}]}], ",", " ", 
         RowBox[{"Width", "\[Rule]", " ", "1920"}], ",", " ", 
         RowBox[{"Height", "\[Rule]", " ", "1080"}], ",", 
         RowBox[{"Blocks", "\[Rule]", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"16", ",", "9"}], "}"}], "*", "2"}]}], ",", " ", 
         RowBox[{"Frequency", "\[Rule]", " ", 
          RowBox[{"1", "/", "10"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SendImage", "[", "blimg", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"cimg", "=", 
       RowBox[{"GetImage", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ManipulatePixelChooser", "[", "cimg", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.846249486418683*^9, 3.846249633065463*^9}, {
  3.846249689018692*^9, 3.846249695137508*^9}, {3.8462500632023797`*^9, 
  3.8462500739462566`*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"04e10cb5-a4eb-4c88-93ae-445fdb1bfb7e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetPhasesBlazeBlock", "[", 
     RowBox[{"row_", ",", "col_", ",", " ", "pixr_", ",", " ", "pixc_", ",", 
      RowBox[{"step_", ":", "0.1"}], ",", " ", 
      RowBox[{"periods_", ":", "3"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "data", ",", "prog1", ",", "prog2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"prog1", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<Generating blaze \>\"", ",", " ", 
         RowBox[{"Dynamic", "[", "prog1", "]"}], ",", " ", "\"\<%\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"blimgs", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"prog1", "=", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"100", "*", 
               RowBox[{"ph", "/", "periods"}]}], ",", " ", "3"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"BlazedMode", "[", 
            RowBox[{"row", ",", "col", ",", "ph", ",", 
             RowBox[{"BlazeAngle", "\[Rule]", " ", 
              RowBox[{"45", "Degree"}]}], ",", " ", 
             RowBox[{"Width", "\[Rule]", " ", "1920"}], ",", " ", 
             RowBox[{"Height", "\[Rule]", " ", "1080"}], ",", 
             RowBox[{"Blocks", "\[Rule]", " ", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"16", ",", "9"}], "}"}], "*", "2"}]}], ",", " ", 
             RowBox[{"Frequency", "\[Rule]", " ", 
              RowBox[{"1", "/", "10"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "ph", ",", " ", "0", ",", " ", "periods", ",", " ", "step"}], 
           "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"prog2", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<Reading intesity probe ... \>\"", ",", " ", 
         RowBox[{"Dynamic", "[", "prog2", "]"}], ",", " ", "\"\<%\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"Length", "[", "blimgs", "]"}]}], ",", " ", 
         RowBox[{"i", "+=", "1"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"prog2", "=", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{"i", "/", 
              RowBox[{"Length", "[", "blimgs", "]"}]}], ",", "3"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"SendImage", "[", 
           RowBox[{"blimgs", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"cimg", "=", 
           RowBox[{"GetImage", "[", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"data", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "*", "step"}], ",", 
              RowBox[{"Norm", "[", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ImageData", "@", "cimg"}], ")"}], "[", 
                RowBox[{"[", 
                 RowBox[{"pixr", ",", " ", "pixc"}], "]"}], "]"}], "]"}]}], 
             "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "data"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.846250111131216*^9, 3.846250616015747*^9}, {
  3.8462506800576496`*^9, 3.846250695852693*^9}, {3.8462507888461695`*^9, 
  3.846250822450656*^9}, {3.8462508849440594`*^9, 3.846250889661335*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"33ec2dd0-9487-4f3a-861f-7c132638f3dc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"data", "=", 
  RowBox[{"GetPhasesBlazeBlock", "[", 
   RowBox[{"1", ",", "1", ",", "212", ",", "896"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.846250724336302*^9, 3.8462507363003592`*^9}, {
  3.8462507934073563`*^9, 3.846250794747365*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"eb2258ac-8093-40cf-a1de-648e0f8d0220"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.6792356108113244`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2`", ",", "0.17660125881094435`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.30000000000000004`", ",", "0.19697832713528407`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.4`", ",", "0.19018597102717083`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5`", ",", "1.419602426595668`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6000000000000001`", ",", "1.7320508075688772`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7000000000000001`", ",", "1.6709196025958581`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8`", ",", "1.7320508075688772`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9`", ",", "1.5962036854066124`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "1.1071540456224587`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1`", ",", "0.32603309318943574`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.2000000000000002`", ",", "0.3667872298381152`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.3`", ",", "0.4415031470273609`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.4000000000000001`", ",", "0.12905476605415164`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.5`", ",", "0.8762139379466085`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.6`", ",", "1.3788482899469885`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.7000000000000002`", ",", "1.365263577730762`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.8`", ",", "1.589411329298499`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.9000000000000001`", ",", "1.3380941532983093`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.`", ",", "1.0120610601088735`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.1`", ",", "0.305656024865096`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.2`", ",", "1.1003616895143455`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.3000000000000003`", ",", "0.43471079091924764`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.4000000000000004`", ",", "0.12226240994603839`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.5`", ",", "1.141115826163025`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.6`", ",", "1.7320508075688772`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.7`", ",", "1.4603565632443476`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.8000000000000003`", ",", "1.3516788655145355`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.9000000000000004`", ",", "1.0663999089737795`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.`", ",", "0.35999487373000194`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.1`", ",", "0.2309401076758503`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.846250865559388*^9, 3.846250930639516*^9},
 CellLabel->
  "Out[188]=",ExpressionUUID->"83383f9f-38c3-4903-99c2-022b87f43b0d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", "data", "]"}]], "Input",
 CellChangeTimes->{{3.84625078006752*^9, 3.84625078121074*^9}, {
  3.846250869292487*^9, 3.84625086991318*^9}, {3.8462509544813633`*^9, 
  3.8462509547625666`*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"0a859f74-858c-4fe4-87f6-734f93e19499"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ManipulatePixelChooser", "[", "cimg", "]"}]], "Input",
 FontWeight->"Plain",
 CellLabel->
  "In[180]:=",ExpressionUUID->"9b6d443e-5b4f-41b7-b4de-be5446422474"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Chosen pixel (row, col): \"\>", "\[InvisibleSpace]", 
   DynamicBox[ToBoxes[$CellContext`pixelpos, StandardForm],
    ImageSizeCache->{62., {3., 10.}}]}],
  SequenceForm["Chosen pixel (row, col): ", 
   Dynamic[$CellContext`pixelpos]],
  Editable->False]], "Print",
 CellChangeTimes->{3.846249701375332*^9, 3.8462500045232935`*^9},
 CellLabel->
  "During evaluation of \
In[180]:=",ExpressionUUID->"40794d2c-5087-46f8-981f-d5dd7bf0f9da"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"TestBlazeBlock", "[", 
  RowBox[{"0", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.8462495805781126`*^9, 3.8462495830314283`*^9}, {
  3.846249616949773*^9, 3.84624961727977*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"d712dfcb-a8fd-455e-bbc3-422774292777"],

Cell[BoxData[
 RowBox[{
  RowBox[{"blimgs", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"prog", "=", "ph"}], ";", "\[IndentingNewLine]", 
      RowBox[{"BlazedMode", "[", 
       RowBox[{"17", ",", "31", ",", "ph", ",", 
        RowBox[{"BlazeAngle", "\[Rule]", " ", 
         RowBox[{"45", "Degree"}]}], ",", " ", 
        RowBox[{"Width", "\[Rule]", " ", "1920"}], ",", " ", 
        RowBox[{"Height", "\[Rule]", " ", "1080"}], ",", 
        RowBox[{"Blocks", "\[Rule]", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"16", ",", "9"}], "}"}], "*", "2"}]}], ",", " ", 
        RowBox[{"Frequency", "\[Rule]", " ", 
         RowBox[{"1", "/", "10"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"ph", ",", " ", "0", ",", " ", "1", ",", " ", "0.1"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8462462687772875`*^9, 3.8462463531903205`*^9}, {
   3.846246864361741*^9, 3.84624686450436*^9}, {3.8462469502329893`*^9, 
   3.8462469722321215`*^9}, {3.846247535063853*^9, 3.846247604582839*^9}, {
   3.846247772918769*^9, 3.846247773142171*^9}, {3.846247809142898*^9, 
   3.846247869542183*^9}, 3.846247950935382*^9, {3.846248036087355*^9, 
   3.846248093621395*^9}, {3.8462481264545364`*^9, 3.8462481605971456`*^9}, {
   3.8462481911105537`*^9, 3.8462482161176367`*^9}, {3.846248252454474*^9, 
   3.846248254149937*^9}, {3.8462482890466857`*^9, 3.8462483776212397`*^9}, {
   3.84624849498322*^9, 3.8462484950460525`*^9}, {3.8462485470300145`*^9, 
   3.846248586820569*^9}, {3.8462486234775143`*^9, 3.8462486284851117`*^9}, {
   3.8462486662779803`*^9, 3.846248680948724*^9}, {3.846249263636468*^9, 
   3.8462492673315797`*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"97f983a5-fd89-4858-8f1d-9c5a61ea3ff1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", " ", 
    RowBox[{"i", " ", "<=", " ", 
     RowBox[{"5", "*", 
      RowBox[{"Length", "@", "blimgs"}]}]}], ",", 
    RowBox[{"i", "+=", "1"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"prog", "=", 
      RowBox[{"N", "[", 
       RowBox[{"i", "/", 
        RowBox[{"Length", "@", "blimgs"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SendImage", "[", 
      RowBox[{"blimgs", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "blimgs"}]}], "]"}], "+", "1"}], "]"}], 
       "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8462476225218353`*^9, 3.84624763832655*^9}, {
  3.846247672742484*^9, 3.8462477092541013`*^9}, {3.8462484014634676`*^9, 
  3.846248431077224*^9}, {3.8462485796387587`*^9, 3.846248591620724*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"660c9d2f-186f-49ab-a311-425b9e1a001e"],

Cell[CellGroupData[{

Cell["Pick Intensity Probe", "Subsubsection",
 CellChangeTimes->{{3.846242258913486*^9, 
  3.846242269818902*^9}},ExpressionUUID->"c8d0863a-3de9-4fe9-b85d-\
787380a82a66"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ManipulatePixelChooser", "[", "img", "]"}]], "Input",
 CellChangeTimes->{{3.8462422890070343`*^9, 3.846242311793518*^9}, 
   3.846242397003724*^9, {3.8462424462785683`*^9, 3.846242450689423*^9}, {
   3.8462424817570057`*^9, 3.8462424833164473`*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"2f47c0d3-ea77-4297-b450-b712bcd09da7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Chosen pixel (row, col): \"\>", "\[InvisibleSpace]", 
   DynamicBox[ToBoxes[$CellContext`pixelpos, StandardForm],
    ImageSizeCache->{62., {3., 10.}}]}],
  SequenceForm["Chosen pixel (row, col): ", 
   Dynamic[$CellContext`pixelpos]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.846242312579804*^9, 3.8462424512406693`*^9, {3.8462424838799686`*^9, 
   3.846242541110156*^9}},
 CellLabel->
  "During evaluation of \
In[185]:=",ExpressionUUID->"ad97046d-f6ea-4f03-9b03-dcd7b037cb8a"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.844857300608103*^9, 3.844857300621572*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"f0a93ce0-bc7a-44fd-9067-ed192c5e5378"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"*", " ", 
   RowBox[{"CloseLink", "[", "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"close", " ", "link", " ", "and", " ", "re"}], "-", 
     RowBox[{
     "run", " ", "EstablishLink", " ", "if", " ", "something", " ", "goes", 
      " ", "wrong"}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8448126745521493`*^9, 3.844812683212143*^9}, {
  3.8448194624663143`*^9, 3.8448194797363005`*^9}, {3.8458187365126653`*^9, 
  3.8458187370752974`*^9}},ExpressionUUID->"7740d38b-c4b2-4119-9977-\
de7e5804281b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Program", "Subsubsection",
 CellChangeTimes->{{3.8462460137731905`*^9, 
  3.846246023788307*^9}},ExpressionUUID->"5515b50c-3be7-4541-8174-\
675a1d8d093a"],

Cell[BoxData[
 RowBox[{"Check", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", " ", "=", " ", "25.0"}], ",", " ", 
     RowBox[{"i", " ", ">=", "  ", "15"}], ",", " ", 
     RowBox[{"i", "+=", " ", 
      RowBox[{"-", "0.1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lgimg", "=", " ", 
       RowBox[{"BlazeImage", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TwoLGPhase", "[", "\[IndentingNewLine]", 
          RowBox[{"0", ",", "1", ",", "0", ",", " ", "3", ",", " ", 
           RowBox[{"ScalingFactor", "->", " ", ".00001"}], ",", " ", 
           RowBox[{"Width", "->", " ", "1920"}], ",", " ", 
           RowBox[{"Height", "->", " ", "1080"}], ",", " ", 
           RowBox[{"WaveVector", "->", " ", 
            FractionBox[
             RowBox[{"2", "\[Pi]"}], 
             RowBox[{"532", " ", 
              SuperscriptBox["10", 
               RowBox[{"-", "9"}]]}]]}], ",", " ", 
           RowBox[{"BeamWaist", "->", " ", 
            RowBox[{"2", "  ", 
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Z", "->", " ", "i"}]}], "]"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"0", "Degree"}], ",", " ", 
         RowBox[{"Frequency", "->", " ", 
          RowBox[{"1", "/", "2"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SendImage", "[", "lgimg", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", "\"\<Sent Image, Pausing ...\>\"", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Pause", "[", "2", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", "\"\<Getting Image ...\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cimg", " ", "=", " ", 
       RowBox[{"GetImage", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"images3", ",", " ", "cimg"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"i", ",", " ", "\"\< Got \>\"", ",", " ", 
        RowBox[{"Dimensions", "@", 
         RowBox[{"ImageData", "@", "cimg"}]}], ",", " ", "\"\<\\n\>\""}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Abort", "[", "]"}]}], "]"}]], "Input",ExpressionUUID->"a671ef6a-\
1e9d-4eeb-802a-73bc78381980"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{958, 988},
WindowMargins->{{0, Automatic}, {5, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 158, 3, 68, "Section",ExpressionUUID->"4498e5ef-0615-419a-a4b1-d782d057b57e"],
Cell[CellGroupData[{
Cell[763, 29, 179, 3, 55, "Subsection",ExpressionUUID->"c4dfaf84-2c43-4350-a874-89f86c93ea28"],
Cell[945, 34, 16255, 373, 2194, "Input",ExpressionUUID->"b754dcd4-23db-4d47-9ec4-43e5e5b071df"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17249, 413, 161, 3, 68, "Section",ExpressionUUID->"b16162da-563c-4a90-abc1-472c54479c57"],
Cell[17413, 418, 22138, 509, 2654, "Input",ExpressionUUID->"ca61e84a-d11e-4ed6-be56-450c09accd1d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39588, 932, 162, 3, 68, "Section",ExpressionUUID->"cc2b96f4-0361-462a-a09f-990f2bbda4a7"],
Cell[39753, 937, 19773, 487, 2539, "Input",ExpressionUUID->"a52f47e8-1e79-4921-b0e6-9f2200a6d2fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59563, 1429, 154, 3, 68, "Section",ExpressionUUID->"14fe7b53-3818-4c4b-a89c-7e6a9f07834d"],
Cell[59720, 1434, 973, 18, 31, "Input",ExpressionUUID->"1e6df731-359c-4c01-aa6a-e0a4d67cdb5e"],
Cell[60696, 1454, 565, 9, 31, "Input",ExpressionUUID->"ed5242f1-b95a-47c3-ae4a-8264be5686d4"],
Cell[61264, 1465, 210, 4, 31, "Input",ExpressionUUID->"2c98b153-1fb0-4069-817c-4b01c437dcbe"],
Cell[61477, 1471, 654, 15, 78, "Input",ExpressionUUID->"3c79b155-deb1-4c5f-bd6b-d5cb74ecde81"],
Cell[62134, 1488, 695, 16, 55, "Input",ExpressionUUID->"c37999df-1cfb-48c6-8e66-bb91749427c0"],
Cell[62832, 1506, 410, 7, 31, "Input",ExpressionUUID->"c9961828-1154-4656-8d06-77ca425a6fda"],
Cell[63245, 1515, 212, 3, 31, "Input",ExpressionUUID->"1012af6c-994c-4089-bc68-3f564c561e8f"],
Cell[63460, 1520, 437, 9, 31, "Input",ExpressionUUID->"758482e8-4b4d-428a-82ef-3fad19fb3091"],
Cell[63900, 1531, 242, 5, 31, "Input",ExpressionUUID->"dc8a95ce-7526-4f34-a2c7-8f859397264e"],
Cell[64145, 1538, 512, 10, 31, "Input",ExpressionUUID->"6f234b90-b3b1-49e6-a02b-aa51e2bb663c"],
Cell[64660, 1550, 487, 12, 55, "Input",ExpressionUUID->"03136c75-adcf-4771-bd1a-db87122899a8"],
Cell[65150, 1564, 201, 4, 31, "Input",ExpressionUUID->"7f255c3a-9bc1-4866-aad4-fd2e85b48626"],
Cell[CellGroupData[{
Cell[65376, 1572, 283, 5, 55, "Input",ExpressionUUID->"fdbbadfe-7e6b-4033-8dd9-d145914da6f1"],
Cell[65662, 1579, 237, 4, 35, "Output",ExpressionUUID->"be578372-0d25-4d16-9c9d-856e7eb76efc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65936, 1588, 653, 14, 55, "Input",ExpressionUUID->"cb01f7c2-c90f-4247-b2ea-ced8713e2770"],
Cell[66592, 1604, 617, 14, 53, "Output",ExpressionUUID->"695389bf-c743-45cc-9c9c-83a32e6faaa1"]
}, Open  ]],
Cell[67224, 1621, 153, 3, 31, "Input",ExpressionUUID->"0c90c4a1-718c-446e-bc11-7bed10fd86f3"],
Cell[67380, 1626, 1426, 32, 170, "Input",ExpressionUUID->"04e10cb5-a4eb-4c88-93ae-445fdb1bfb7e"],
Cell[68809, 1660, 4050, 90, 538, "Input",ExpressionUUID->"33ec2dd0-9487-4f3a-861f-7c132638f3dc"],
Cell[CellGroupData[{
Cell[72884, 1754, 348, 7, 31, "Input",ExpressionUUID->"eb2258ac-8093-40cf-a1de-648e0f8d0220"],
Cell[73235, 1763, 2846, 67, 151, "Output",ExpressionUUID->"83383f9f-38c3-4903-99c2-022b87f43b0d"]
}, Open  ]],
Cell[76096, 1833, 316, 6, 31, "Input",ExpressionUUID->"0a859f74-858c-4fe4-87f6-734f93e19499"],
Cell[CellGroupData[{
Cell[76437, 1843, 183, 4, 31, "Input",ExpressionUUID->"9b6d443e-5b4f-41b7-b4de-be5446422474"],
Cell[76623, 1849, 486, 11, 25, "Print",ExpressionUUID->"40794d2c-5087-46f8-981f-d5dd7bf0f9da"]
}, Open  ]],
Cell[77124, 1863, 291, 6, 31, "Input",ExpressionUUID->"d712dfcb-a8fd-455e-bbc3-422774292777"],
Cell[77418, 1871, 1850, 35, 147, "Input",ExpressionUUID->"97f983a5-fd89-4858-8f1d-9c5a61ea3ff1"],
Cell[79271, 1908, 1057, 27, 101, "Input",ExpressionUUID->"660c9d2f-186f-49ab-a311-425b9e1a001e"],
Cell[CellGroupData[{
Cell[80353, 1939, 171, 3, 46, "Subsubsection",ExpressionUUID->"c8d0863a-3de9-4fe9-b85d-787380a82a66"],
Cell[CellGroupData[{
Cell[80549, 1946, 356, 6, 31, "Input",ExpressionUUID->"2f47c0d3-ea77-4297-b450-b712bcd09da7"],
Cell[80908, 1954, 541, 13, 25, "Print",ExpressionUUID->"ad97046d-f6ea-4f03-9b03-dcd7b037cb8a"]
}, Open  ]],
Cell[81464, 1970, 175, 3, 31, "Input",ExpressionUUID->"f0a93ce0-bc7a-44fd-9067-ed192c5e5378"],
Cell[81642, 1975, 567, 13, 31, "Input",ExpressionUUID->"7740d38b-c4b2-4119-9977-de7e5804281b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82246, 1993, 160, 3, 46, "Subsubsection",ExpressionUUID->"5515b50c-3be7-4541-8174-675a1d8d093a"],
Cell[82409, 1998, 2416, 51, 479, "Input",ExpressionUUID->"a671ef6a-1e9d-4eeb-802a-73bc78381980"]
}, Open  ]]
}, Open  ]]
}
]
*)

