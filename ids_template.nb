(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     81046,       1878]
NotebookOptionsPosition[     72782,       1752]
NotebookOutlinePosition[     73116,       1767]
CellTagsIndexPosition[     73073,       1764]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Parse Aberration Correction", "Section",
 CellChangeTimes->{{3.852887253156039*^9, 3.8528872765238667`*^9}, {
   3.85288831460737*^9, 3.852888320141602*^9}, 
   3.852889748726748*^9},ExpressionUUID->"fa5e9463-f3a0-4663-9a57-\
f1aae8bf0e2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LoadAberrationData", "[", 
     RowBox[{"path_", ",", " ", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"{", 
        RowBox[{"Blocks", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{"32", ",", "18"}], "}"}]}], "}"}], "]"}]}], "]"}], ":=", 
    " ", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nw", ",", "nh"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ListQ", "@", 
          RowBox[{"OptionValue", "@", "Blocks"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"nw", ",", "nh"}], "}"}], "=", 
          RowBox[{"OptionValue", "@", "Blocks"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nw", " ", "=", " ", 
           RowBox[{"OptionValue", "@", "Blocks"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nh", "=", "nw"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"TABLE", "=", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"path", ",", " ", "\"\<Table\>\""}], "]"}], ",", " ", 
          RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",\

 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQ3df84jX/yjeOHjEsb0B0xaFpH0C0+ZYb30E002W3
SBkgbZHq0ACiL1xXaAHRB4/WdoDoiL/NPSB61bV3E0H0keYju0D03/0Jx0G0
kvHm0yD6zvXOGyDaacpvBTkgvTBtgzaIbjpWagCiLSZb24FoQ3E2NxCdavrT
B0R3FOwIBtGnNhZGgmg3qfJEED1F0jkNRPP39OSA6D9PLTpB9IY1Hb0g+tyl
I2BarGvLNBBdOuHpLBCdtfvRPBA9Z6PkQhD9TyBwLYiWTlHcAFZ/duNuEJ35
+Pk+EC3AKHoKRPOE2oJpp0Ofz4HoTTdkH4Loe1FnPoLoJ0ulPoFol9kfvoLo
lv7abyA6Jd3iN4gO+1TLIA+k55keYQXRX20/ioBoh78bUs9seeMomOiUBqIB
dg/PNA==
  "],ExpressionUUID->"cf1fe083-fe7f-43d4-8fd3-f9bba4a1dc84"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ParseAberrationData", "[", 
     RowBox[{"step_:", "0.05"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"list", " ", "of", " ", 
        RowBox[{"(", 
         RowBox[{"phase", ",", " ", "value"}], ")"}], " ", "pairs", " ", 
        "for", " ", "plotting"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PHASES", " ", "=", " ", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"j", "-", "3"}], ")"}], "*", "step"}], ",", " ", 
              RowBox[{"TABLE", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"j", ",", "3", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"TABLE", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "@", "TABLE"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"PHASESMAX", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"step", "*", 
           RowBox[{"TABLE", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "@", "TABLE"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdyk8oQwEAx/Fn4aS2gz9t/m2uLqTllaZttBxcEJkc0N5ECq1FaSVvh03z
L2sHtNrBgag3dsCKrIeabWkr20FiM8TSNo00k/fb4dvn8pWMTHZTPIIgRFxw
mX595+8kFB2DhQk467ElYbMr8g15IZW6ipOk5PPwJiw2wvMLgwn252gL3L39
WIMszZ7A3NnQFaxrOryGd2FzBCqtWXENp0PL1MOFS30DJNdbWmFjRbEKUtKf
TmiaOuqBXue0GqpEM8PQKmzTQr7FMgF/46QZMnumJRgIsnnLF102qF+Nb8Bx
d9QOt5xCB/wTdO3DSo2Eyf9+pxuOxV5OoaCgzAtLemV5lZ7PADyIVD/C+wFf
Cj5ti9KwfTOZgcYVwxfUjJJZ2Jc2ELWcdilbBDOyVCmU5xjK50ooot45LXzT
PQT9nM/HsRD8B/Pg3Gg=
  
  "],ExpressionUUID->"ffb01604-be76-430c-bcd7-596b41202562"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TestBlazeBlock", "[", 
    RowBox[{"row_", ",", "col_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"blimg", ",", "cimg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"blimg", "=", 
       RowBox[{"BlazedMode", "[", 
        RowBox[{"row", ",", "col", ",", "0", ",", 
         RowBox[{"BlazeAngle", "\[Rule]", " ", 
          RowBox[{"45", "Degree"}]}], ",", " ", 
         RowBox[{"Width", "\[Rule]", " ", "1920"}], ",", " ", 
         RowBox[{"Height", "\[Rule]", " ", "1080"}], ",", 
         RowBox[{"Blocks", "\[Rule]", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"16", ",", "9"}], "}"}], "*", "2"}]}], ",", " ", 
         RowBox[{"Frequency", "\[Rule]", " ", 
          RowBox[{"1", "/", "10"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SendImage", "[", "blimg", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"cimg", "=", 
       RowBox[{"GetImage", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ManipulatePixelChooser", "[", "cimg", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdyk8oQwEAx/Fn4aS2gz9t/m2uLqTllaZttBxcEJkc0N5ECmlRWsmm3vT8
y1pCqx0ciHpjB1mR9VCzLY1sB4mxiKVtGmkm77fDt8/lKxsYbacEBEFI+OCi
6fVduB1TtfTmxuCUxxaH9a7wNxRca7RlvCSlnIFXIakZnp4ZadidMTFw5/Zj
BXIm7ghmTvouYFXdwSW8C1nCUG1NSyt4HXq2Gs6eG2ogudrQCGtL8jWQkv+0
QnrssAN6neNaqJFM9kOruEkPhQwzAn+jpAWyu/QCDAS5rMXzLhs0LEfX4bA7
YoebTrED/ona9mCpTsZmf7/TDYeeXo6hKKfICws6FVnVns8A3A+XP8L7Hl8C
Pm9JkrB5I56C5iXjF9QNkmnYlTQSlbx2OZcHU4pEIVRmWMrniqki3mk9fJt4
CPp559bEN/Af6zrbHQ==
  
  "],ExpressionUUID->"ebd69a85-9a96-47ce-8c96-88c49a6cf0bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetPhasesBlazeBlock", "[", 
     RowBox[{"row_", ",", "col_", ",", " ", "pixr_", ",", " ", "pixc_", ",", 
      RowBox[{"step_", ":", "0.1"}], ",", " ", 
      RowBox[{"periods_", ":", "3"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "data", ",", "prog1", ",", "prog2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"prog1", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<Generating blaze \>\"", ",", " ", 
         RowBox[{"Dynamic", "[", "prog1", "]"}], ",", " ", "\"\<%\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"blimgs", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"prog1", "=", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"100", "*", 
               RowBox[{"ph", "/", "periods"}]}], ",", " ", "3"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"BlazedMode", "[", 
            RowBox[{"row", ",", "col", ",", "ph", ",", 
             RowBox[{"BlazeAngle", "\[Rule]", " ", 
              RowBox[{"45", "Degree"}]}], ",", " ", 
             RowBox[{"Width", "\[Rule]", " ", "1920"}], ",", " ", 
             RowBox[{"Height", "\[Rule]", " ", "1080"}], ",", 
             RowBox[{"Blocks", "\[Rule]", " ", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"16", ",", "9"}], "}"}], "*", "2"}]}], ",", " ", 
             RowBox[{"Frequency", "\[Rule]", " ", 
              RowBox[{"1", "/", "10"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "ph", ",", " ", "0", ",", " ", "periods", ",", " ", "step"}], 
           "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"prog2", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<Reading intesity probe ... \>\"", ",", " ", 
         RowBox[{"Dynamic", "[", "prog2", "]"}], ",", " ", "\"\<%\>\""}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", " ", 
         RowBox[{"i", " ", "<=", " ", 
          RowBox[{"Length", "[", "blimgs", "]"}]}], ",", " ", 
         RowBox[{"i", "+=", "1"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"prog2", "=", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{"i", "/", 
              RowBox[{"Length", "[", "blimgs", "]"}]}], ",", "3"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"SendImage", "[", 
           RowBox[{"blimgs", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"cimg", "=", 
           RowBox[{"GetImage", "[", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"data", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "*", "step"}], ",", 
              RowBox[{"Norm", "[", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ImageData", "@", "cimg"}], ")"}], "[", 
                RowBox[{"[", 
                 RowBox[{"pixr", ",", " ", "pixc"}], "]"}], "]"}], "]"}]}], 
             "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "data"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdyk8oQwEAx/Fn4aS2gz9t/m2uLqTllaZttBxcEJkc0N5ECmlRWsmm3vT8
y1pCqx0ciHpjB1mR9VCzLY1sB4mxiKVtGmkm77fDt8/lKxsYbacEBEFI+OCi
6fVduB1TtfTmxuCUxxaH9a7wNxRca7RlvCSlnIFXIakZnp4ZadidMTFw5/Zj
BXIm7ghmTvouYFXdwSW8C1nCUG1NSyt4HXq2Gs6eG2ogudrQCGtL8jWQkv+0
QnrssAN6neNaqJFM9kOruEkPhQwzAn+jpAWyu/QCDAS5rMXzLhs0LEfX4bA7
YoebTrED/ona9mCpTsZmf7/TDYeeXo6hKKfICws6FVnVns8A3A+XP8L7Hl8C
Pm9JkrB5I56C5iXjF9QNkmnYlTQSlbx2OZcHU4pEIVRmWMrniqki3mk9fJt4
CPp559bEN/Af6zrbHQ==
  
  "],ExpressionUUID->"ee02c627-b7c1-43bd-afdd-547726884a72"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utility Functions", "Section",
 CellChangeTimes->{{3.852890458460816*^9, 
  3.852890462915831*^9}},ExpressionUUID->"9d61a7ff-3e44-4fbd-b301-\
a1bdfbd9305e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "crop", " ", "image", " ", "to", " ", "be", " ", "a", " ", "square"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MakeSquare", "[", 
     RowBox[{"image_", ",", " ", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Raw", "\[Rule]", " ", "False"}], ",", " ", 
         RowBox[{"Size", "\[Rule]", " ", "0"}]}], "}"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"data", ",", "m", ",", "mx", ",", "cx", ",", "cy", ",", "d"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"data", "=", 
        RowBox[{
         RowBox[{"ImageData", "[", 
          RowBox[{"ColorConvert", "[", 
           RowBox[{"image", ",", " ", "\"\<GrayScale\>\""}], "]"}], "]"}], 
         "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", ";;", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mx", " ", "=", " ", 
        RowBox[{"Min", "[", 
         RowBox[{"Dimensions", "@", "data"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "Size", "]"}], " ", ">", " ", "0"}], 
           " ", "&&", " ", 
           RowBox[{
            RowBox[{"OptionValue", "[", "Size", "]"}], " ", "<", " ", 
            "mx"}]}], ",", 
          RowBox[{"OptionValue", "[", "Size", "]"}], ",", "mx"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cx", ",", "cy"}], "}"}], "=", " ", 
        RowBox[{"Floor", "[", 
         RowBox[{
          RowBox[{"Dimensions", "@", "data"}], "/", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            RowBox[{"cx", "-", 
             RowBox[{"Floor", "[", 
              RowBox[{"m", "/", "2"}], "]"}], "+", "1"}], ";;", 
            RowBox[{"cx", "+", 
             RowBox[{"Floor", "[", 
              RowBox[{"m", "/", "2"}], "]"}]}]}], ",", " ", 
           RowBox[{
            RowBox[{"cy", "-", 
             RowBox[{"Floor", "[", 
              RowBox[{"m", "/", "2"}], "]"}], "+", "1"}], ";;", 
            RowBox[{"cy", "+", 
             RowBox[{"Floor", "[", 
              RowBox[{"m", "/", "2"}], "]"}]}]}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "Raw", "]"}], ",", " ", "d", ",", " ", 
         RowBox[{"Image", "[", "d", "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.852890474817224*^9, 
  3.85289048159482*^9}},ExpressionUUID->"8e203c0b-a990-4b73-9070-\
5d52acc04fcc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"return", " ", "rasterized", " ", "image", " ", "of", " ", 
    RowBox[{"amplitude", "/", "phase"}], " ", "plots"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PlotAmpPhase", "[", 
     RowBox[{"amp_", ",", " ", "phase_", ",", " ", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"AmpRange", " ", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"Raw", "\[Rule]", " ", "False"}], ",", " ", 
         RowBox[{"TitleSuffix", " ", "\[Rule]", " ", "\"\<\>\""}], ",", " ", 
         RowBox[{
         "AmpColorMap", " ", "\[Rule]", " ", "\"\<ThermometerColors\>\""}], 
         ",", " ", 
         RowBox[{"ColumnSize", " ", "\[Rule]", " ", "Full"}], ",", " ", 
         RowBox[{"AmpImageSize", " ", "\[Rule]", " ", "Automatic"}], ",", " ", 
         RowBox[{"PhaseImageSize", " ", "\[Rule]", " ", "Automatic"}]}], 
        "}"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2", ",", " ", "arange", ",", " ", "amax"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arange", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ListQ", "@", 
           RowBox[{"OptionValue", "[", "AmpRange", "]"}]}], ",", " ", 
          "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"OptionValue", "[", "AmpRange", "]"}], ",", "\n", 
          "\t\t\t\t   ", 
          RowBox[{
           RowBox[{"amax", " ", "=", " ", 
            RowBox[{"Max", "[", "amp", "]"}]}], ";", "\n", 
           "\t\t\t            ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"amax", " ", ">", " ", "1"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "amax"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "1"}], "}"}]}], "]"}]}]}], "\n", 
         "\t\t\t     ", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"p1", " ", "=", " ", 
        RowBox[{"ArrayPlot", "[", 
         RowBox[{"amp", ",", "  ", 
          RowBox[{"PlotLabel", " ", "->", " ", 
           RowBox[{"\"\<Amplitude \>\"", " ", "<>", " ", 
            RowBox[{"OptionValue", "[", "TitleSuffix", "]"}]}]}], ",", " ", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"PlotLegends", " ", "->", " ", "Automatic"}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", "\[IndentingNewLine]",
           "\t\t", 
          RowBox[{"ColorFunction", " ", "->", " ", 
           RowBox[{"OptionValue", "[", "AmpColorMap", "]"}]}], ",", " ", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"PlotRange", " ", "->", " ", "arange"}], ",", " ", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"ImageSize", "\[Rule]", " ", 
           RowBox[{"OptionValue", "[", "AmpImageSize", "]"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"ColorFunctionScaling", " ", "->", " ", "True"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p2", " ", "=", " ", 
        RowBox[{"ArrayPlot", "[", 
         RowBox[{"phase", ",", 
          RowBox[{"PlotLabel", " ", "->", " ", 
           RowBox[{"\"\<Phase \>\"", " ", "<>", " ", 
            RowBox[{"OptionValue", "[", "TitleSuffix", "]"}]}]}], ",", 
          "\[IndentingNewLine]", "\t\t ", 
          RowBox[{"PlotLegends", " ", "->", " ", 
           RowBox[{"BarLegend", "[", 
            RowBox[{"{", 
             RowBox[{"Hue", ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", "\[IndentingNewLine]",
           "\t\t", 
          RowBox[{"ColorFunction", " ", "->", " ", "Hue"}], ",", " ", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"ImageSize", "\[Rule]", " ", 
           RowBox[{"OptionValue", "[", "PhaseImageSize", "]"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"PlotRange", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1"}], "}"}]}], ",", " ", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"ColorFunctionScaling", " ", "->", " ", "False"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "[", "\"\<Rasterizing ... \>\"", "]"}], ";", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "Raw", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"p1", ",", " ", "p2"}], "}"}], ",", 
         RowBox[{"Rasterize", "[", 
          RowBox[{"Column", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"p1", ",", " ", "p2"}], "}"}], ",", "Center", ",", 
            RowBox[{"ItemSize", "\[Rule]", " ", 
             RowBox[{"OptionValue", "[", "ColumnSize", "]"}]}]}], "]"}], 
          "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.852890486517605*^9, 3.852890529517695*^9}, {
  3.852890591982026*^9, 3.852890801078925*^9}, {3.852890853567981*^9, 
  3.852890872768341*^9}, {3.852891169280121*^9, 3.8528912207797203`*^9}, {
  3.852891271694873*^9, 3.852891295568797*^9}, {3.8528913561745358`*^9, 
  3.852891365751761*^9}, {3.852891424619362*^9, 3.852891467760025*^9}, {
  3.852891511631331*^9, 3.8528915409059963`*^9}, {3.852891604993334*^9, 
  3.8528916334466257`*^9}, {3.852898747527457*^9, 3.852898781759914*^9}, {
  3.852916078328257*^9, 3.852916078794622*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"a639225b-d52b-4a77-b2ea-de5395806f3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Program", "Section",
 CellChangeTimes->{{3.844812067143608*^9, 
  3.8448120691335983`*^9}},ExpressionUUID->"14fe7b53-3818-4c4b-a89c-\
7e6a9f07834d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "\"\</home/hfl/ldata/edu/guoy_phase/laguerre/LG.wl\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "<<", "\"\</home/hfl/ldata/edu/guoy_phase/mathematica_ids/ids.wl\>\""}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.852888333526183*^9, 3.8528883468875437`*^9}, {
  3.85288843398554*^9, 3.852888447102848*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"f679a5a9-66aa-4884-95f2-a7c0324693f9"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"*", " ", 
   RowBox[{"EstablishLink", "[", "0", "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"start", " ", "link"}], ",", " ", 
     RowBox[{"make", " ", "sure", " ", "ueye_link", " ", 
      RowBox[{"is", " ", "'"}], "waiting", " ", "for", " ", 
      RowBox[{"connection", "'"}]}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8448120743536024`*^9, 3.8448120788936095`*^9}, {
   3.844812747042141*^9, 3.8448127479521427`*^9}, {3.844813029742141*^9, 
   3.844813030422144*^9}, {3.8448163574657917`*^9, 3.844816358055791*^9}, {
   3.8448194345662947`*^9, 3.844819458166295*^9}, {3.8448571425476294`*^9, 
   3.8448571426432943`*^9}, {3.845583108261401*^9, 3.845583108450591*^9}, {
   3.845584551266966*^9, 3.845584552577474*^9}, 3.8456700732748957`*^9, {
   3.845670156211924*^9, 3.845670156390291*^9}, {3.845818730480789*^9, 
   3.845818732348241*^9}},ExpressionUUID->"1e6df731-359c-4c01-aa6a-\
e0a4d67cdb5e"],

Cell[BoxData[
 RowBox[{"EstablishLink", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.846201278840493*^9, 3.846201281284244*^9}, {
  3.8462020537536507`*^9, 3.8462020540103607`*^9}, {3.846202286468583*^9, 
  3.846202286598235*^9}, {3.846202665787912*^9, 3.846202665867302*^9}, {
  3.8462031240393476`*^9, 3.846203124195291*^9}, {3.846203574666224*^9, 
  3.8462035748753977`*^9}, {3.8462462400395155`*^9, 3.84624624009951*^9}, {
  3.8462494465012207`*^9, 3.8462494465913744`*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"ed5242f1-b95a-47c3-ae4a-8264be5686d4"],

Cell[BoxData[
 RowBox[{"StartLG", "[", 
  RowBox[{
  "\"\</home/hfl/ldata/edu/guoy_phase/laguerre/bin\>\"", ",", " ", 
   "\"\<lg\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.852890273389844*^9, 3.852890301876034*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"43436595-a5ba-4fd9-80f3-34ad8bb8823e"],

Cell[BoxData[
 RowBox[{"CloseLG", "[", "]"}]], "Input",
 CellChangeTimes->{{3.8462466205553136`*^9, 3.8462466228868527`*^9}, {
  3.85272513335499*^9, 3.852725133994217*^9}, {3.852727092711917*^9, 
  3.852727093339032*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"2c98b153-1fb0-4069-817c-4b01c437dcbe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToString", "[", 
  RowBox[{"1.2", " ", 
   SuperscriptBox["10", "6"]}], "]"}]], "Input",
 CellChangeTimes->{{3.852752181122513*^9, 3.852752246534547*^9}, {
   3.852752472248837*^9, 3.852752566988172*^9}, {3.852752606315929*^9, 
   3.8527526298544827`*^9}, {3.8527526620178623`*^9, 3.852752668764312*^9}, 
   3.85289047090974*^9, {3.852898978888857*^9, 3.8528989878904333`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"cd21246d-0b9e-4c19-86c9-b5f69fe44d48"],

Cell[BoxData["\<\"      6\\n1.2 10\"\>"], "Output",
 CellChangeTimes->{{3.852898984574257*^9, 3.852898988256472*^9}},
 CellLabel->"Out[23]=",ExpressionUUID->"515631c9-1c47-489c-ad7f-ec28302a89d8"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "512"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"guasmag", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"N", " ", "[", 
      RowBox[{"Exp", "[", 
       FractionBox[
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}]}], "20000"], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", 
       RowBox[{"-", "n"}], ",", " ", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"y", ",", " ", 
       RowBox[{"-", "n"}], ",", " ", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Rasterize", "[", 
  RowBox[{"Column", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Image", "[", "guasmag", "]"}], ",", " ", 
     RowBox[{"Image", "[", "lgp", "]"}]}], "}"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8527560104484167`*^9, 3.852756016423675*^9}, {
   3.852756067231351*^9, 3.852756243619956*^9}, {3.8527563009392347`*^9, 
   3.852756304162471*^9}, {3.8527572234438667`*^9, 3.852757265564405*^9}, 
   3.852761351763859*^9, {3.8529212426892014`*^9, 3.8529212431199217`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"4229400b-2d75-4f93-b834-19c07354606b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "@", "guasmag"}]], "Input",
 CellChangeTimes->{{3.852756195309667*^9, 3.852756198473699*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"e88bee3d-425e-4d39-9f6b-112d08246750"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"512", ",", "512"}], "}"}]], "Output",
 CellChangeTimes->{{3.8527561988169622`*^9, 3.852756231775188*^9}, 
   3.852756316557991*^9},
 CellLabel->
  "Out[299]=",ExpressionUUID->"8b992c5a-55ce-4183-8816-302a8092c438"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"imgs", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"PrintTemporary", "[", "z", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", " ", "=", " ", 
       RowBox[{"LGMag", "[", 
        RowBox[{"0", ",", "1", ",", " ", 
         RowBox[{"Z", "\[Rule]", " ", "z"}], ",", 
         RowBox[{"Size", " ", "\[Rule]", " ", "512"}], ",", " ", 
         RowBox[{"Clamp", " ", "\[Rule]", " ", "False"}], ",", " ", 
         RowBox[{"Raw", " ", "\[Rule]", " ", "True"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dp", " ", "=", " ", 
       RowBox[{"LGPhase", "[", 
        RowBox[{"0", ",", "1", ",", " ", 
         RowBox[{"Z", "\[Rule]", " ", "z"}], ",", 
         RowBox[{"Size", " ", "\[Rule]", " ", "512"}], ",", "  ", 
         RowBox[{"Raw", " ", "\[Rule]", " ", "True"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotAmpPhase", "[", 
       RowBox[{"d", ",", " ", "dp", ",", " ", 
        RowBox[{"AmpRange", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], ",", " ", 
        RowBox[{"TitleSuffix", "\[Rule]", " ", 
         RowBox[{"\"\<z = \>\"", "<>", 
          RowBox[{"TextString", "[", "z", "]"}]}]}], ",", " ", 
        RowBox[{"AmpImageSize", "\[Rule]", " ", "Large"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z", ",", "  ", 
       RowBox[{"-", "10000000.1"}], ",", " ", "10000000", ",", " ", 
       "1000000"}], "}"}]}], " ", "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.852892374736504*^9, 3.852892383624795*^9}, {
  3.852893003126795*^9, 3.8528930041192617`*^9}, {3.852893044112471*^9, 
  3.852893046525576*^9}, {3.852893080916803*^9, 3.852893086297617*^9}, {
  3.852893200326219*^9, 3.8528932587357073`*^9}, {3.852893388288064*^9, 
  3.8528933883936253`*^9}, {3.8528964837061777`*^9, 3.852896495585867*^9}, {
  3.852896651309682*^9, 3.8528966846020193`*^9}, {3.852898060481503*^9, 
  3.852898177935882*^9}, {3.8528982109246902`*^9, 3.852898262184655*^9}, {
  3.8528982953735447`*^9, 3.8528983886788807`*^9}, {3.852898429932726*^9, 
  3.852898433268434*^9}, {3.852898578612569*^9, 3.8528985811687737`*^9}, {
  3.852898703666904*^9, 3.8528987142729053`*^9}, {3.852898829027194*^9, 
  3.852898890339615*^9}, {3.85289895924686*^9, 3.852898959671177*^9}, {
  3.852899051985564*^9, 3.852899068624474*^9}, {3.8528991210492773`*^9, 
  3.852899125223695*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"bdad2440-4586-41aa-bffe-eac1c8a0e4c0"],

Cell[BoxData[
 RowBox[{"Module", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"dz", "=", "0"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Rasterize", "@", 
    RowBox[{"Column", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PropagateField", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lgm", ",", " ", "lgp"}], "}"}], ",", "dz", ",", 
        RowBox[{"AmpRange", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], ",", " ", 
        RowBox[{"WaveVector", "\[Rule]", " ", 
         RowBox[{"2", "\[Pi]"}]}], ",", " ", 
        RowBox[{"AmpImageSize", "\[Rule]", " ", "Large"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"TitleSuffix", "\[Rule]", " ", 
         RowBox[{"\"\< dz = \>\"", "<>", 
          RowBox[{"TextString", "[", "dz", "]"}]}]}]}], "]"}], ",", " ", 
      "\[IndentingNewLine]", "Center"}], "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.852901642485591*^9, 3.852901676022501*^9}, 
   3.852901718660679*^9},
 CellLabel->
  "In[127]:=",ExpressionUUID->"e59a61a7-819d-4ef2-92ef-57f9b364674f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dftimgs2", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{
        RowBox[{"-", "1000000"}], "+", "dz"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Rasterize", "@", 
       RowBox[{"Column", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PropagateField", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"guasmag", ",", " ", "lgp"}], "}"}], ",", "dz", ",", 
           RowBox[{"AmpRange", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}]}], ",", " ", 
           RowBox[{"WaveVector", "\[Rule]", " ", 
            RowBox[{"2", "\[Pi]"}]}], ",", "\[IndentingNewLine]", " ", 
           RowBox[{"AmpColorFunctionScaling", " ", "\[Rule]", " ", "True"}], 
           ",", 
           RowBox[{"AmpImageSize", "\[Rule]", " ", "Large"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"TitleSuffix", "\[Rule]", " ", 
            RowBox[{"\"\< dz = \>\"", "<>", 
             RowBox[{"TextString", "[", "dz", "]"}]}]}]}], "]"}], ",", " ", 
         "\[IndentingNewLine]", "Center"}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"dz", ",", " ", "0", ",", " ", "5000000", ",", " ", "100000"}], 
      "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.852899476681919*^9, 3.852899483135915*^9}, {
   3.852899649362769*^9, 3.852899665242116*^9}, {3.852899707926536*^9, 
   3.8528997082781487`*^9}, {3.852899991921595*^9, 3.852900045751782*^9}, {
   3.852900181145094*^9, 3.8529001828767853`*^9}, {3.852900437179563*^9, 
   3.85290058545728*^9}, {3.85290070396987*^9, 3.852900758559416*^9}, {
   3.852901405997734*^9, 3.85290141748384*^9}, {3.8529058699269047`*^9, 
   3.852905871856352*^9}, {3.852906295967886*^9, 3.85290631138061*^9}, {
   3.8529067883990507`*^9, 3.852906804623167*^9}, {3.852906839551045*^9, 
   3.852906855278166*^9}, {3.8529074579387302`*^9, 3.852907492987603*^9}, {
   3.852909817467661*^9, 3.8529098376905107`*^9}, {3.8529186724122667`*^9, 
   3.8529186725268173`*^9}, {3.852918774248672*^9, 3.852918774343367*^9}, {
   3.852918980338188*^9, 3.852918989968104*^9}, {3.852919079339781*^9, 
   3.8529191062346487`*^9}, {3.852919248333823*^9, 3.852919271408595*^9}, {
   3.852920174390317*^9, 3.8529201947351627`*^9}, 3.8529202268079653`*^9, {
   3.852920568963346*^9, 3.8529205696676493`*^9}, {3.852921278008482*^9, 
   3.852921287813841*^9}, {3.8529213965298443`*^9, 3.852921398581027*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"7d8ba6c4-4e83-4fb5-8022-3837062f01b5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\</tmp/lg0102dft_guass.flv\>\"", ",", " ", "dftimgs2"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.852921788447309*^9, 3.8529218172489567`*^9}, {
  3.852921885126638*^9, 3.852921885325162*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"0b150d3b-0700-4051-b984-e9a13898ed14"],

Cell[BoxData["\<\"/tmp/lg0102dft_guass.flv\"\>"], "Output",
 CellChangeTimes->{3.852921858260405*^9, 3.852921953763082*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"78bbd7dc-2f53-4578-a050-744530f9bc7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\</tmp/lg0122dft.gif\>\"", ",", "dftimgs1"}], "]"}]], "Input",
 CellChangeTimes->{{3.8529187488388166`*^9, 3.852918763411701*^9}, {
  3.852919420557124*^9, 3.852919499289916*^9}, {3.852920908280141*^9, 
  3.852920925859893*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"e394221c-ec3c-498c-8fb4-3bc6fe36b0db"],

Cell[BoxData["\<\"/tmp/lg0122dft.gif\"\>"], "Output",
 CellChangeTimes->{
  3.852918763742228*^9, 3.852918848124852*^9, 3.852919041542445*^9, 
   3.852919208641059*^9, {3.852919421617783*^9, 3.852919446934417*^9}, {
   3.852919495914856*^9, 3.8529195212761393`*^9}, {3.852920939550021*^9, 
   3.852920956419663*^9}},
 CellLabel->"Out[49]=",ExpressionUUID->"21647823-c969-4847-a860-1850d17f8eff"]
}, Open  ]],

Cell["With delta = 10.0", "Text",
 CellChangeTimes->{{3.852900135948924*^9, 
  3.852900178003788*^9}},ExpressionUUID->"026c7671-b895-4d52-b466-\
0d1affcbd19d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lg0102", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lgm", ",", " ", "lgp"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"PrintTemporary", "[", "z", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"lgm", "=", 
         RowBox[{"TwoLGMag", "[", 
          RowBox[{"0", ",", "1", ",", "0", ",", "2", " ", ",", 
           RowBox[{"Z", "\[Rule]", " ", "z"}], ",", 
           RowBox[{"Size", " ", "\[Rule]", " ", "1024"}], ",", " ", 
           RowBox[{"Clamp", " ", "\[Rule]", " ", "False"}], ",", " ", 
           RowBox[{"Raw", " ", "\[Rule]", " ", "True"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lgp", "=", 
         RowBox[{"TwoLGPhase", "[", 
          RowBox[{"0", ",", "1", ",", "0", ",", "2", ",", 
           RowBox[{"Z", "\[Rule]", " ", "z"}], ",", 
           RowBox[{"Size", " ", "\[Rule]", " ", "1024"}], ",", " ", 
           RowBox[{"Raw", " ", "\[Rule]", " ", "True"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotAmpPhase", "[", 
         RowBox[{"lgm", ",", " ", "lgp", ",", " ", 
          RowBox[{"AmpImageSize", "\[Rule]", " ", "Large"}], ",", " ", 
          RowBox[{"AmpRange", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "2"}], "}"}]}], ",", " ", 
          RowBox[{"TitleSuffix", "\[Rule]", " ", 
           RowBox[{"\"\<z = \>\"", "<>", 
            RowBox[{"TextString", "[", "z", "]"}]}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"z", ",", " ", 
         RowBox[{"-", "1000000"}], ",", " ", "5000000", ",", " ", "500000"}], 
        "}"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwlzE0ow3EAxvHh4uCwsjRZ3l/CDWtCMRQthFJsy2Fsa2QraVgszctBE4e9
eC9EaXk5aI6ySVvqvzBmL1pcUIqVWGj5PT+Hp8/l6Zsl07TL41ksVgYZ5G5b
Ez1Hr8KUww8OXDxr4kF1m5labjPzYeA4Qp09cFdDT9V4HfxmflqhZbiiHQq9
u520tyXvhrubYRnMfVP1QLbKM31FXDcnz0G9IWyCzQq+GY5tP65DWzBC/Xyp
FF/jdzFBtYU2lqFWIFiBKY4y0w2xukNJbWR8yz5iSbRmFXobuqfuiJtMaAZ2
rhRuQLvydw+2XFqdcDap6xw+O7hePzHVFbuFuriBJxhxB5/hCPf0C+YviqPQ
HpG8B4j7xlUqb4bJDRJFOZN5UOdmiyBHaKDWLvXK4WdpsgI6LFWDMJQWo7YW
ME6Y+VB/Dkv0RkmIuBctkkLel1gNR6T5GriWUDwKta5/d+b7hu6J6f2jWljr
XzBATvYJ9Q/UIShA
  "],
 CellLabel->"In[64]:=",ExpressionUUID->"3a2e6b25-f514-4aef-b1f9-81aac94de75d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\</tmp/lg0102real.gif\>\"", ",", " ", 
   RowBox[{"lg0102", "[", 
    RowBox[{"[", 
     RowBox[{";;", "11"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.852919628244296*^9, 3.852919652820113*^9}, {
  3.852920889330378*^9, 3.852920901926221*^9}, {3.852921989378584*^9, 
  3.852922000803212*^9}, {3.8529220658644867`*^9, 3.852922071014414*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"8b795baa-3eb7-46e1-a664-62ead0fe0061"],

Cell[BoxData["\<\"/tmp/lg0102real.gif\"\>"], "Output",
 CellChangeTimes->{{3.852919648724246*^9, 3.8529196537602*^9}, {
  3.852920898356893*^9, 3.852920912864339*^9}, {3.8529219974982853`*^9, 
  3.85292200778043*^9}, {3.852922073962775*^9, 3.852922075889686*^9}},
 CellLabel->"Out[72]=",ExpressionUUID->"dbdb820b-5eda-4264-b077-b79770344c74"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"z", "=", 
     RowBox[{"-", "1000000"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lgm", "=", 
     RowBox[{"TwoLGMag", "[", 
      RowBox[{"0", ",", "1", ",", "0", ",", "2", " ", ",", 
       RowBox[{"Z", "\[Rule]", " ", "z"}], ",", 
       RowBox[{"Size", " ", "\[Rule]", " ", "1024"}], ",", " ", 
       RowBox[{"Clamp", " ", "\[Rule]", " ", "False"}], ",", " ", 
       RowBox[{"Raw", " ", "\[Rule]", " ", "True"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lgp", "=", 
     RowBox[{"TwoLGPhase", "[", 
      RowBox[{"0", ",", "1", ",", "0", ",", " ", "2", ",", 
       RowBox[{"Z", "\[Rule]", " ", "z"}], ",", 
       RowBox[{"Size", " ", "\[Rule]", " ", "1024"}], ",", " ", 
       RowBox[{"Raw", " ", "\[Rule]", " ", "True"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"PlotAmpPhase", "[", 
    RowBox[{"lgm", ",", " ", "lgp", ",", " ", 
     RowBox[{"AmpImageSize", "\[Rule]", " ", "Large"}], ",", " ", 
     RowBox[{"AmpRange", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "2"}], "}"}]}], ",", " ", 
     RowBox[{"TitleSuffix", "\[Rule]", " ", 
      RowBox[{"\"\<z = \>\"", "<>", 
       RowBox[{"TextString", "[", "z", "]"}]}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.852916649539103*^9, 3.8529166976779127`*^9}, {
  3.852916952443057*^9, 3.852917021404348*^9}, {3.852917240527257*^9, 
  3.852917313967848*^9}, {3.85291755758106*^9, 3.8529176224080973`*^9}, {
  3.852918246662065*^9, 3.852918290591072*^9}, {3.852918602348011*^9, 
  3.8529186549082623`*^9}, {3.8529201311179237`*^9, 3.852920159905442*^9}, {
  3.8529205356043587`*^9, 3.852920536683537*^9}, {3.852921312141967*^9, 
  3.852921345077874*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"80f67321-161d-48b6-be08-85b5479031f3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\</tmp/lg0102.gif\>\"", ",", " ", "lg0102"}], "]"}]], "Input",
 CellChangeTimes->{{3.8529151592668657`*^9, 3.852915172275186*^9}, {
   3.852916492451757*^9, 3.852916494304723*^9}, {3.852916896930496*^9, 
   3.852916905007435*^9}, 3.852917220829612*^9, {3.852917407001762*^9, 
   3.8529174161510563`*^9}, {3.852917535106545*^9, 3.852917536378615*^9}, {
   3.8529180200861998`*^9, 3.852918026537813*^9}, {3.852918546826353*^9, 
   3.852918553716751*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"4969bbad-8b51-4b36-a5f7-e9130c9dc1b4"],

Cell[BoxData["\<\"/tmp/lg0102.gif\"\>"], "Output",
 CellChangeTimes->{
  3.852915194149828*^9, {3.8529164883651037`*^9, 3.852916497016665*^9}, {
   3.852916899941107*^9, 3.852916926842949*^9}, 3.8529172429581614`*^9, 
   3.8529175125806713`*^9, 3.852917557527565*^9, {3.852918043698453*^9, 
   3.8529180695913067`*^9}, 3.852918557324156*^9},
 CellLabel->
  "Out[230]=",ExpressionUUID->"251432a5-82eb-4763-bf70-1c7c2a74466c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lgzx", "=", 
   RowBox[{"TwoLGMag", "[", 
    RowBox[{"0", ",", "1", ",", "3", ",", "2", " ", ",", 
     RowBox[{"Z", "\[Rule]", " ", "z"}], ",", 
     RowBox[{"Size", " ", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{"2048", ",", "1024"}], "}"}]}], ",", " ", 
     RowBox[{"Delta", " ", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["10", "4"], ",", "10"}], "}"}]}], ",", 
     RowBox[{"Plane", "\[Rule]", " ", "\"\<ZX\>\""}], ",", " ", 
     RowBox[{"Clamp", " ", "\[Rule]", " ", "False"}], ",", " ", 
     RowBox[{"Raw", " ", "\[Rule]", " ", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ArrayPlot", "[", 
  RowBox[{"lgzx", ",", "  ", 
   RowBox[{"PlotLabel", " ", "->", " ", 
    RowBox[{
    "\"\<Amplitude ZX (\!\(\*SubscriptBox[\(\[Delta]\), \(x\)]\)=\>\"", "<>", 
     
     RowBox[{"TextString", "[", 
      SuperscriptBox["10", "4"], "]"}], "<>", 
     "\"\<, \!\(\*SubscriptBox[\(\[Delta]\), \(y\)]\)=\>\"", "<>", 
     RowBox[{"TextString", "[", "10", "]"}], "<>", "\"\<)\>\""}]}], ",", " ", 
   "\[IndentingNewLine]", "\t\t", 
   RowBox[{"PlotLegends", " ", "->", " ", "Automatic"}], ",", 
   "\[IndentingNewLine]", "\t\t", 
   RowBox[{"ColorFunction", " ", "->", " ", "\"\<ThermometerColors\>\""}], 
   ",", " ", "\[IndentingNewLine]", "\t\t", 
   RowBox[{"PlotRange", " ", "->", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "4"}], "}"}]}], ",", " ", "\[IndentingNewLine]", 
   "\t\t", 
   RowBox[{"ImageSize", "\[Rule]", " ", "Large"}], ",", "\[IndentingNewLine]",
    "\t\t", 
   RowBox[{"ColorFunctionScaling", " ", "->", " ", "True"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8529129660974407`*^9, 3.852913079895021*^9}, {
   3.852913167795291*^9, 3.85291330339345*^9}, 3.852914862891658*^9, {
   3.8529149865730553`*^9, 3.852914989637843*^9}, {3.852915557890414*^9, 
   3.852915619090662*^9}, {3.8529160514168053`*^9, 3.8529160518462467`*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"919dc90b-da16-47fa-a2eb-92f000850036"],

Cell["with z = -4 000 000", "Text",
 CellChangeTimes->{{3.852901065267322*^9, 
  3.852901071138826*^9}},ExpressionUUID->"4cf97618-4861-4427-a289-\
d49a0639abfa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ampData", "=", 
   RowBox[{"MakeSquare", "[", 
    RowBox[{",", " ", 
     RowBox[{"Raw", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"Size", "\[Rule]", " ", "512"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phData", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"0", "&"}], ",", " ", 
     RowBox[{"Dimensions", "[", "ampData", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"{", 
    RowBox[{"ampData", ",", "phData"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Image", "[", "ampData", "]"}]}], "Input",
 CellChangeTimes->{{3.852752249144732*^9, 3.852752260846497*^9}, {
   3.852752291359926*^9, 3.8527524240183287`*^9}, {3.852752574068282*^9, 
   3.8527525761266203`*^9}, {3.852752688013071*^9, 3.85275268981565*^9}, {
   3.85275349893769*^9, 3.8527535072887163`*^9}, 
   3.852935653062313*^9},ExpressionUUID->"f4cb808b-70cc-417e-babb-\
f2db6c1e7c2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PrintTemporary", "[", "z", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Rasterize", "[", "\[IndentingNewLine]", 
       RowBox[{"Column", "[", "\[IndentingNewLine]", 
        RowBox[{"PropagateField", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"guasmag", ",", " ", "lgp"}], "}"}], ",", " ", "z", ",", 
          " ", 
          RowBox[{"AmpRange", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1.7"}], "}"}]}], ",", 
          RowBox[{"WaveVector", "\[Rule]", " ", "10"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"z", ",", " ", "0.0", ",", " ", "10000", ",", " ", "100"}], 
      "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8527347942047567`*^9, 3.8527349221071997`*^9}, {
   3.852735061106515*^9, 3.852735063418784*^9}, {3.8527354250795507`*^9, 
   3.852735425571409*^9}, {3.8527354728202133`*^9, 3.8527354765889473`*^9}, {
   3.852743617286192*^9, 3.852743620559721*^9}, {3.852743769544331*^9, 
   3.8527437751511707`*^9}, 3.852743806101935*^9, 3.852743866068342*^9, {
   3.852749130091237*^9, 3.852749136940605*^9}, {3.852749243047613*^9, 
   3.852749255418795*^9}, {3.852751138433313*^9, 3.85275116815565*^9}, {
   3.8527513375925627`*^9, 3.852751339779307*^9}, {3.852753971767481*^9, 
   3.852753976636392*^9}, 3.8527541472027483`*^9, {3.8527544727784147`*^9, 
   3.852754478751103*^9}, {3.852754795640287*^9, 3.852754795881589*^9}, {
   3.8527551587053967`*^9, 3.8527551606087713`*^9}, {3.852756444490687*^9, 
   3.8527564838445377`*^9}, {3.852756833362968*^9, 3.852756840248485*^9}},
 CellLabel->
  "In[327]:=",ExpressionUUID->"30d678db-0c10-450b-a6e2-c080a502af21"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\</tmp/lg-guass-norm.gif\>\"", ",", " ", "pdata"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.852756676821817*^9, 3.852756689596043*^9}, {
  3.852757009103664*^9, 3.8527570098025227`*^9}},
 CellLabel->
  "In[328]:=",ExpressionUUID->"d7225777-6863-449e-bcec-e3bd5d5fe06d"],

Cell[BoxData["\<\"/tmp/lg-guass-norm.gif\"\>"], "Output",
 CellChangeTimes->{3.852756692286683*^9, 3.852757012201955*^9},
 CellLabel->
  "Out[328]=",ExpressionUUID->"50fdfdfd-3cd8-4e21-a68b-e902fe38bbcc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"PropagateField", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"guasmag", ",", " ", "lgp"}], "}"}], ",", "00", ",", 
    RowBox[{"AmpRange", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], ",", 
    RowBox[{"WaveVector", "\[Rule]", " ", "10"}], ",", 
    RowBox[{"AmpColorMap", "\[Rule]", " ", "\"\<ThermometerColors\>\""}]}], 
   "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.852751413573318*^9, 3.852751474984521*^9}, {
   3.8527515724911947`*^9, 3.852751578064019*^9}, {3.852751626131316*^9, 
   3.852751631646104*^9}, {3.852751736629595*^9, 3.852751739955575*^9}, 
   3.8527523452527113`*^9, {3.852752449182619*^9, 3.852752449419841*^9}, {
   3.8527526996370773`*^9, 3.8527527319753027`*^9}, {3.852752770317178*^9, 
   3.852752801961938*^9}, {3.85275301702112*^9, 3.85275303530087*^9}, {
   3.8527533304491463`*^9, 3.852753398830118*^9}, {3.852753547501156*^9, 
   3.852753587174882*^9}, {3.852753831153372*^9, 3.852753837602854*^9}, {
   3.852753910669738*^9, 3.852753958310522*^9}, {3.852754353869462*^9, 
   3.852754393769793*^9}, {3.8527550725370827`*^9, 3.852755149096683*^9}, {
   3.85275561040091*^9, 3.852755702399053*^9}, {3.852755875154043*^9, 
   3.852755880582348*^9}, {3.852755971419997*^9, 3.8527559954755096`*^9}, 
   3.852756262063344*^9, {3.85275636228889*^9, 3.852756433463344*^9}, {
   3.8527567815435534`*^9, 3.852756792857793*^9}},
 CellLabel->
  "In[326]:=",ExpressionUUID->"27e4b33d-d8ff-4da4-b372-d05da7e31c73"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"anim", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PrintTemporary", "[", "i", "]"}], ";", 
      RowBox[{"Rasterize", "[", 
       RowBox[{"Column", "[", 
        RowBox[{"pdata", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", 
       RowBox[{"Length", "@", "pdata"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\</tmp/lg2.gif\>\"", ",", " ", "anim"}], "]"}], ";"}]}], "Input",\

 CellChangeTimes->{{3.852754568287142*^9, 3.852754579543479*^9}, {
  3.852754670763402*^9, 3.852754676007578*^9}, {3.8527547145035048`*^9, 
  3.852754775528452*^9}, {3.852754836499836*^9, 3.852754880950857*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"3b7ea660-8c11-4e99-b3e2-7c02260338e1"],

Cell[BoxData[
 RowBox[{"ListAnimate", "[", 
  RowBox[{"pdata", ",", " ", 
   RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.852751348876193*^9, 3.8527513572624483`*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"c7121959-69b9-45a9-b0a0-4b187a9ad113"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.852749971167877*^9, 3.8527499798420887`*^9}, 
   3.8527511722602463`*^9},ExpressionUUID->"fe9f040d-8251-496e-bf12-\
6361be7c2e8b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", " ", "b"}], "}"}], "=", 
   RowBox[{"PropagateField", "[", 
    RowBox[{"data", ",", " ", "0", ",", " ", 
     RowBox[{"FourierSpace", "\[Rule]", " ", "True"}], ",", " ", 
     RowBox[{"Raw", "\[Rule]", " ", "True"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a2", ",", " ", "b2"}], "}"}], "=", 
   RowBox[{"PropagateField", "[", 
    RowBox[{"data", ",", " ", "0.3", ",", " ", 
     RowBox[{"WaveVector", "\[Rule]", " ", "10"}], ",", " ", 
     RowBox[{"FourierSpace", "\[Rule]", " ", "True"}], ",", " ", 
     RowBox[{"Raw", "\[Rule]", " ", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diff", "=", 
   RowBox[{"a2", "-", "a"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ArrayPlot", "[", 
  RowBox[{"diff", ",", " ", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8527502461111727`*^9, 3.8527502556977673`*^9}, {
  3.852750365227879*^9, 3.852750387445325*^9}, {3.852750456221059*^9, 
  3.8527504566411533`*^9}, {3.852750636068804*^9, 3.852750702913322*^9}, {
  3.8527508377619343`*^9, 3.852750995252996*^9}, {3.852751048982093*^9, 
  3.852751053380982*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"669d5cfe-cefc-491f-a7bc-31aebde012ca"],

Cell[BoxData[
 RowBox[{"ArrayPlot", "[", 
  RowBox[{
   RowBox[{"pdata", "[", 
    RowBox[{"[", 
     RowBox[{"5", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", " ", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Amplitude\>\""}], " ", ",", 
   RowBox[{"ColorFunction", "\[Rule]", "\"\<TemperatureMap\>\""}], ",", " ", 
   RowBox[{"ColorFunctionScaling", "\[Rule]", "  ", "False"}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.852748804068439*^9, 3.852748851998825*^9}, {
  3.852748912320879*^9, 3.8527489477631817`*^9}, {3.852749032738503*^9, 
  3.852749038083619*^9}, {3.8527490980832253`*^9, 3.85274912331649*^9}, {
  3.8527491827240267`*^9, 3.852749224599715*^9}, {3.852750071245216*^9, 
  3.852750076414578*^9}},
 CellLabel->
  "In[663]:=",ExpressionUUID->"d3423956-3261-4515-95b7-b2f1a42057be"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"res", " ", "=", " ", 
   RowBox[{"Propagate", "[", 
    RowBox[{"10.0", ",", " ", "1.0", ",", "5.0", ",", "1", ",", "data"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"amp", ",", " ", "phase"}], "}"}], "=", "res"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phase", "=", 
   FractionBox[
    RowBox[{"Mod", "[", 
     RowBox[{"phase", ",", " ", 
      RowBox[{"2", "\[Pi]"}]}], "]"}], 
    RowBox[{"2", "\[Pi]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListDensityPlot", "[", 
  RowBox[{"amp", ",", " ", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", " ", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Amplitude\>\""}], " ", ",", " ", 
   RowBox[{"InterpolationOrder", "\[Rule]", "0"}], ",", " ", 
   RowBox[{"ColorFunctionScaling", "\[Rule]", "  ", "True"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListDensityPlot", "[", 
  RowBox[{"phase", ",", " ", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"BarLegend", "[", 
     RowBox[{"{", 
      RowBox[{"Hue", ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ColorFunction", "\[Rule]", "Hue"}], ",", " ", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Phase\>\""}], ",", " ", 
   RowBox[{"ColorFunctionScaling", "\[Rule]", " ", "False"}], ",", " ", 
   RowBox[{"InterpolationOrder", "\[Rule]", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdx00ogwEAh/GNTdpqS1umEbMmpU0+WtSUtsNMWVgtY5PSxMpXvBRZY9kc
tqZcpqymrOyApB3sgPnIlCxWyAG5SdqkiGmb9/8enn495f1juoEcGo1WSgZZ
qeL0XOhdeXFqzEDiZtpsJQ2qcgfhAWes3UbqbpF0wKG6mSNIFzRHYL2u4Aya
7DxKS/QvBru8FXHoFEfuIKNl8QsGWNosJGyTlGaPjjFPmgyvM+FtxFsEzYII
pSlIF8FETTPlcTYugxp2VS18HFmWw/ENRQO8uyxrglLmNWVQZmyFmbBECw8t
LwbI2XZ2Q6V0vhdW++SDUJ/qHIYf3yuj0N22SsCA5mEKFhIuKyyq3KZM5ezZ
4avBuATVJ/4nOOFYe4bn+VH7AqnKEXPBAev9MiSYCz6Y18PdhJ5P7Rb1jtld
KLzShSBb6P+BDH7fLxSZLBm4b3uj20kVegkPytNqPkzIkiWwkbsjhv+Bwf6p

  "],
 CellLabel->
  "In[560]:=",ExpressionUUID->"033e801c-6247-4f1b-a871-3c27711a2cc7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ColorData", "[", "\"\<Hue\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.852730486662222*^9, 3.852730547003826*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"49a8f348-d8ba-493d-8cf9-78d0f30a2cca"],

Cell[BoxData[
 TemplateBox[{
  "ColorData","notent",
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"Hue\\\\\\\"\\\"}]\\) is not a known \
entity, class, or tag for \\!\\(\\*RowBox[{\\\"ColorData\\\"}]\\). Use \\!\\(\
\\*RowBox[{\\\"ColorData\\\"}]\\)[] for a list of entities.\"",2,129,38,
   17174168621392168261,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.852730502304315*^9, 3.852730547262939*^9}},
 CellLabel->
  "During evaluation of \
In[129]:=",ExpressionUUID->"263b5a62-894e-425c-9c6a-b7ea747c334d"],

Cell[BoxData[
 RowBox[{"ColorData", "[", "\<\"Hue\"\>", "]"}]], "Output",
 CellChangeTimes->{
  3.852724211196704*^9, {3.852725039209893*^9, 3.85272504976836*^9}, {
   3.852725150772757*^9, 3.852725175229072*^9}, 3.852725301344315*^9, 
   3.852725415700952*^9, 3.8527255522189493`*^9, 3.8527257718992367`*^9, 
   3.8527258840286922`*^9, 3.852726018031364*^9, 3.852726452033166*^9, {
   3.8527266130333157`*^9, 3.852726643025352*^9}, 3.852727078025527*^9, 
   3.852727468027254*^9, 3.852727586029345*^9, 3.852727619805429*^9, 
   3.852727882224679*^9, 3.8527282600320587`*^9, 3.852728566774341*^9, {
   3.852728830393004*^9, 3.85272884299907*^9}, {3.85272894751723*^9, 
   3.852728984712658*^9}, 3.852729265021723*^9, 3.852729331024458*^9, 
   3.85272937101658*^9, 3.852729437020256*^9, 3.8527294677028637`*^9, 
   3.8527296195132008`*^9, 3.852729752452571*^9, {3.8527298386650953`*^9, 
   3.852729858264049*^9}, 3.852729891469393*^9, {3.852730068974926*^9, 
   3.852730097016185*^9}, {3.852730225795437*^9, 3.852730285061026*^9}, 
   3.852730364358992*^9, 3.852730414195099*^9, {3.852730500022612*^9, 
   3.852730547276108*^9}},
 CellLabel->
  "Out[129]=",ExpressionUUID->"34a5923c-d86e-44c6-b8fa-698589618707"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "\"\</home/bk/opt/ldata/edu/guoy_phase/laguerre/LG.wl\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrintTemporary", "[", "\"\<loaded package.\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StartLG", "[", 
   RowBox[{
   "\"\</home/bk/opt/ldata/edu/guoy_phase/laguerre\>\"", ",", " ", 
    "\"\<bin/lg\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8467602143967*^9, 3.846760280899468*^9}, {
  3.846760313678322*^9, 3.84676032270998*^9}, {3.8467605530402117`*^9, 
  3.846760576290605*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"3c79b155-deb1-4c5f-bd6b-d5cb74ecde81"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "<<", "\"\<C:\\\\Users\\\\Physics \
Student\\\\Documents\\\\mathematica_laguerre\\\\Lg.wl\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "StartLG", "[", 
   "\"\<C:\\\\Users\\\\Physics Student\\\\Documents\\\\mathematica_laguerre\>\
\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.845669509841515*^9, 3.8456695261433907`*^9}, {
  3.845670049359408*^9, 3.8456700530160418`*^9}, {3.845818149671233*^9, 
  3.8458182101458073`*^9}, {3.8462067053223333`*^9, 3.846206708544455*^9}, {
  3.846246130905238*^9, 3.8462461386608753`*^9}, {3.8467602606026497`*^9, 
  3.846760260743113*^9}},ExpressionUUID->"c37999df-1cfb-48c6-8e66-\
bb91749427c0"],

Cell[BoxData[
 RowBox[{"LoadAberrationData", "[", 
  "\"\</home/bk/opt/ldata/edu/guoy_phase/aberration_data.dat\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.846206751047542*^9, 3.846206784676424*^9}, {
   3.8462461470030785`*^9, 3.846246154934105*^9}, 3.8467602599119167`*^9, {
   3.846762613345154*^9, 3.8467626690603848`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"c9961828-1154-4656-8d06-77ca425a6fda"],

Cell[BoxData[
 RowBox[{"ParseAberrationData", "[", "]"}]], "Input",
 CellChangeTimes->{{3.846762700922885*^9, 3.846762715758213*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"1012af6c-994c-4089-bc68-3f564c561e8f"],

Cell[BoxData[
 RowBox[{"lg", "=", 
  RowBox[{"LGMag", "[", 
   RowBox[{"1", ",", "0", ",", " ", 
    RowBox[{"ScalingFactor", "\[Rule]", " ", "0.1"}], ",", " ", 
    RowBox[{"Width", "\[Rule]", " ", "1920"}], ",", " ", 
    RowBox[{"Height", "\[Rule]", " ", "1080"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.846764302722698*^9, 3.846764391604946*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"758482e8-4b4d-428a-82ef-3fad19fb3091"],

Cell[BoxData[
 RowBox[{"AddMask", "[", 
  RowBox[{"lg", ",", " ", "img"}], "]"}]], "Input",
 CellChangeTimes->{{3.8467643965289383`*^9, 3.846764400634416*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"dc8a95ce-7526-4f34-a2c7-8f859397264e"],

Cell[BoxData[
 RowBox[{"img", "=", 
  RowBox[{"GenerateMask", "[", 
   RowBox[{"PHASESMAX", ",", 
    RowBox[{"Raw", "\[Rule]", " ", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.846763597976193*^9, 3.8467636153219357`*^9}, {
  3.846763754989677*^9, 3.846763756838279*^9}, {3.846763830240034*^9, 
  3.8467638308744164`*^9}, {3.846763867692471*^9, 3.846763868111236*^9}, {
  3.846764145484324*^9, 3.8467641468798027`*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"6f234b90-b3b1-49e6-a02b-aa51e2bb663c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"blank", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"1080", ",", "1920"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SendImage", "[", "blank", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.846246399130534*^9, 3.846246422758869*^9}, {
  3.846246913528238*^9, 3.8462469139600525`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"03136c75-adcf-4771-bd1a-db87122899a8"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.846246881048123*^9, 3.846246881052112*^9}, {
  3.846246925319688*^9, 
  3.846246927831933*^9}},ExpressionUUID->"7f255c3a-9bc1-4866-aad4-\
fd2e85b48626"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"prog", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", "prog", "]"}]}], "Input",
 CellChangeTimes->{{3.846247576058139*^9, 3.8462475821508665`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"fdbbadfe-7e6b-4033-8dd9-d145914da6f1"],

Cell[BoxData[
 DynamicBox[ToBoxes[$CellContext`prog, StandardForm],
  ImageSizeCache->{34., {3., 7.}}]], "Output",
 CellChangeTimes->{3.8462475828101015`*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"be578372-0d25-4d16-9c9d-856e7eb76efc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BlazedMode", "[", 
  RowBox[{"17", ",", "10", ",", "0", ",", 
   RowBox[{"BlazeAngle", "\[Rule]", " ", 
    RowBox[{"45", "Degree"}]}], ",", " ", 
   RowBox[{"Width", "\[Rule]", " ", "1920"}], ",", " ", 
   RowBox[{"Height", "\[Rule]", " ", "1080"}], ",", 
   RowBox[{"Blocks", "\[Rule]", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"16", ",", "9"}], "}"}], "*", "2"}]}], ",", " ", 
   RowBox[{"Frequency", "\[Rule]", " ", 
    RowBox[{"1", "/", "10"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8462486966127768`*^9, 3.846248750035951*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"cb01f7c2-c90f-4247-b2ea-ced8713e2770"],

Cell[BoxData[
 RowBox[{"BlazedMode", "[", 
  RowBox[{"17", ",", "10", ",", "0", ",", 
   RowBox[{"BlazeAngle", "\[Rule]", 
    RowBox[{"45", " ", "\[Degree]"}]}], ",", 
   RowBox[{"Width", "\[Rule]", "1920"}], ",", 
   RowBox[{"Height", "\[Rule]", "1080"}], ",", 
   RowBox[{"Blocks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"32", ",", "18"}], "}"}]}], ",", 
   RowBox[{"Frequency", "\[Rule]", 
    FractionBox["1", "10"]}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.846760367932961*^9, {3.846762542590246*^9, 3.846762554243067*^9}},
 CellLabel->"Out[11]=",ExpressionUUID->"695389bf-c743-45cc-9c9c-83a32e6faaa1"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8462492587066593`*^9, 
  3.84624925871364*^9}},ExpressionUUID->"0c90c4a1-718c-446e-bc11-\
7bed10fd86f3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"data", "=", 
  RowBox[{"GetPhasesBlazeBlock", "[", 
   RowBox[{"1", ",", "1", ",", "212", ",", "896"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.846250724336302*^9, 3.8462507363003592`*^9}, {
  3.8462507934073563`*^9, 3.846250794747365*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"eb2258ac-8093-40cf-a1de-648e0f8d0220"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "0.6792356108113244`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2`", ",", "0.17660125881094435`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.30000000000000004`", ",", "0.19697832713528407`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.4`", ",", "0.19018597102717083`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5`", ",", "1.419602426595668`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6000000000000001`", ",", "1.7320508075688772`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7000000000000001`", ",", "1.6709196025958581`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8`", ",", "1.7320508075688772`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9`", ",", "1.5962036854066124`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "1.1071540456224587`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1`", ",", "0.32603309318943574`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.2000000000000002`", ",", "0.3667872298381152`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.3`", ",", "0.4415031470273609`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.4000000000000001`", ",", "0.12905476605415164`"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"1.5`", ",", "0.8762139379466085`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.6`", ",", "1.3788482899469885`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.7000000000000002`", ",", "1.365263577730762`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.8`", ",", "1.589411329298499`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.9000000000000001`", ",", "1.3380941532983093`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.`", ",", "1.0120610601088735`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.1`", ",", "0.305656024865096`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.2`", ",", "1.1003616895143455`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.3000000000000003`", ",", "0.43471079091924764`"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"2.4000000000000004`", ",", "0.12226240994603839`"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"2.5`", ",", "1.141115826163025`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.6`", ",", "1.7320508075688772`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.7`", ",", "1.4603565632443476`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.8000000000000003`", ",", "1.3516788655145355`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.9000000000000004`", ",", "1.0663999089737795`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.`", ",", "0.35999487373000194`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.1`", ",", "0.2309401076758503`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.846250865559388*^9, 3.846250930639516*^9},
 CellLabel->
  "Out[188]=",ExpressionUUID->"83383f9f-38c3-4903-99c2-022b87f43b0d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", "data", "]"}]], "Input",
 CellChangeTimes->{{3.84625078006752*^9, 3.84625078121074*^9}, {
  3.846250869292487*^9, 3.84625086991318*^9}, {3.8462509544813633`*^9, 
  3.8462509547625666`*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"0a859f74-858c-4fe4-87f6-734f93e19499"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ManipulatePixelChooser", "[", "cimg", "]"}]], "Input",
 FontWeight->"Plain",
 CellLabel->
  "In[180]:=",ExpressionUUID->"9b6d443e-5b4f-41b7-b4de-be5446422474"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Chosen pixel (row, col): \"\>", "\[InvisibleSpace]", 
   DynamicBox[ToBoxes[$CellContext`pixelpos, StandardForm],
    ImageSizeCache->{62., {3., 10.}}]}],
  SequenceForm["Chosen pixel (row, col): ", 
   Dynamic[$CellContext`pixelpos]],
  Editable->False]], "Print",
 CellChangeTimes->{3.846249701375332*^9, 3.8462500045232935`*^9},
 CellLabel->
  "During evaluation of \
In[180]:=",ExpressionUUID->"40794d2c-5087-46f8-981f-d5dd7bf0f9da"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"TestBlazeBlock", "[", 
  RowBox[{"0", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.8462495805781126`*^9, 3.8462495830314283`*^9}, {
  3.846249616949773*^9, 3.84624961727977*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"d712dfcb-a8fd-455e-bbc3-422774292777"],

Cell[BoxData[
 RowBox[{
  RowBox[{"blimgs", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"prog", "=", "ph"}], ";", "\[IndentingNewLine]", 
      RowBox[{"BlazedMode", "[", 
       RowBox[{"17", ",", "31", ",", "ph", ",", 
        RowBox[{"BlazeAngle", "\[Rule]", " ", 
         RowBox[{"45", "Degree"}]}], ",", " ", 
        RowBox[{"Width", "\[Rule]", " ", "1920"}], ",", " ", 
        RowBox[{"Height", "\[Rule]", " ", "1080"}], ",", 
        RowBox[{"Blocks", "\[Rule]", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"16", ",", "9"}], "}"}], "*", "2"}]}], ",", " ", 
        RowBox[{"Frequency", "\[Rule]", " ", 
         RowBox[{"1", "/", "10"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"ph", ",", " ", "0", ",", " ", "1", ",", " ", "0.1"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8462462687772875`*^9, 3.8462463531903205`*^9}, {
   3.846246864361741*^9, 3.84624686450436*^9}, {3.8462469502329893`*^9, 
   3.8462469722321215`*^9}, {3.846247535063853*^9, 3.846247604582839*^9}, {
   3.846247772918769*^9, 3.846247773142171*^9}, {3.846247809142898*^9, 
   3.846247869542183*^9}, 3.846247950935382*^9, {3.846248036087355*^9, 
   3.846248093621395*^9}, {3.8462481264545364`*^9, 3.8462481605971456`*^9}, {
   3.8462481911105537`*^9, 3.8462482161176367`*^9}, {3.846248252454474*^9, 
   3.846248254149937*^9}, {3.8462482890466857`*^9, 3.8462483776212397`*^9}, {
   3.84624849498322*^9, 3.8462484950460525`*^9}, {3.8462485470300145`*^9, 
   3.846248586820569*^9}, {3.8462486234775143`*^9, 3.8462486284851117`*^9}, {
   3.8462486662779803`*^9, 3.846248680948724*^9}, {3.846249263636468*^9, 
   3.8462492673315797`*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"97f983a5-fd89-4858-8f1d-9c5a61ea3ff1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", " ", 
    RowBox[{"i", " ", "<=", " ", 
     RowBox[{"5", "*", 
      RowBox[{"Length", "@", "blimgs"}]}]}], ",", 
    RowBox[{"i", "+=", "1"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"prog", "=", 
      RowBox[{"N", "[", 
       RowBox[{"i", "/", 
        RowBox[{"Length", "@", "blimgs"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SendImage", "[", 
      RowBox[{"blimgs", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "blimgs"}]}], "]"}], "+", "1"}], "]"}], 
       "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8462476225218353`*^9, 3.84624763832655*^9}, {
  3.846247672742484*^9, 3.8462477092541013`*^9}, {3.8462484014634676`*^9, 
  3.846248431077224*^9}, {3.8462485796387587`*^9, 3.846248591620724*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"660c9d2f-186f-49ab-a311-425b9e1a001e"],

Cell[CellGroupData[{

Cell["Pick Intensity Probe", "Subsubsection",
 CellChangeTimes->{{3.846242258913486*^9, 
  3.846242269818902*^9}},ExpressionUUID->"c8d0863a-3de9-4fe9-b85d-\
787380a82a66"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ManipulatePixelChooser", "[", "img", "]"}]], "Input",
 CellChangeTimes->{{3.8462422890070343`*^9, 3.846242311793518*^9}, 
   3.846242397003724*^9, {3.8462424462785683`*^9, 3.846242450689423*^9}, {
   3.8462424817570057`*^9, 3.8462424833164473`*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"2f47c0d3-ea77-4297-b450-b712bcd09da7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Chosen pixel (row, col): \"\>", "\[InvisibleSpace]", 
   DynamicBox[ToBoxes[$CellContext`pixelpos, StandardForm],
    ImageSizeCache->{62., {3., 10.}}]}],
  SequenceForm["Chosen pixel (row, col): ", 
   Dynamic[$CellContext`pixelpos]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.846242312579804*^9, 3.8462424512406693`*^9, {3.8462424838799686`*^9, 
   3.846242541110156*^9}},
 CellLabel->
  "During evaluation of \
In[185]:=",ExpressionUUID->"ad97046d-f6ea-4f03-9b03-dcd7b037cb8a"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.844857300608103*^9, 3.844857300621572*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"f0a93ce0-bc7a-44fd-9067-ed192c5e5378"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"*", " ", 
   RowBox[{"CloseLink", "[", "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"close", " ", "link", " ", "and", " ", "re"}], "-", 
     RowBox[{
     "run", " ", "EstablishLink", " ", "if", " ", "something", " ", "goes", 
      " ", "wrong"}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8448126745521493`*^9, 3.844812683212143*^9}, {
  3.8448194624663143`*^9, 3.8448194797363005`*^9}, {3.8458187365126653`*^9, 
  3.8458187370752974`*^9}},ExpressionUUID->"7740d38b-c4b2-4119-9977-\
de7e5804281b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Program", "Subsubsection",
 CellChangeTimes->{{3.8462460137731905`*^9, 
  3.846246023788307*^9}},ExpressionUUID->"5515b50c-3be7-4541-8174-\
675a1d8d093a"],

Cell[BoxData[
 RowBox[{"Check", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", " ", "=", " ", "25.0"}], ",", " ", 
     RowBox[{"i", " ", ">=", "  ", "15"}], ",", " ", 
     RowBox[{"i", "+=", " ", 
      RowBox[{"-", "0.1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lgimg", "=", " ", 
       RowBox[{"BlazeImage", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TwoLGPhase", "[", "\[IndentingNewLine]", 
          RowBox[{"0", ",", "1", ",", "0", ",", " ", "3", ",", " ", 
           RowBox[{"ScalingFactor", "->", " ", ".00001"}], ",", " ", 
           RowBox[{"Width", "->", " ", "1920"}], ",", " ", 
           RowBox[{"Height", "->", " ", "1080"}], ",", " ", 
           RowBox[{"WaveVector", "->", " ", 
            FractionBox[
             RowBox[{"2", "\[Pi]"}], 
             RowBox[{"532", " ", 
              SuperscriptBox["10", 
               RowBox[{"-", "9"}]]}]]}], ",", " ", 
           RowBox[{"BeamWaist", "->", " ", 
            RowBox[{"2", "  ", 
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Z", "->", " ", "i"}]}], "]"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"0", "Degree"}], ",", " ", 
         RowBox[{"Frequency", "->", " ", 
          RowBox[{"1", "/", "2"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SendImage", "[", "lgimg", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", "\"\<Sent Image, Pausing ...\>\"", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Pause", "[", "2", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", "\"\<Getting Image ...\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cimg", " ", "=", " ", 
       RowBox[{"GetImage", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"images3", ",", " ", "cimg"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"i", ",", " ", "\"\< Got \>\"", ",", " ", 
        RowBox[{"Dimensions", "@", 
         RowBox[{"ImageData", "@", "cimg"}]}], ",", " ", "\"\<\\n\>\""}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Abort", "[", "]"}]}], "]"}]], "Input",ExpressionUUID->"a671ef6a-\
1e9d-4eeb-802a-73bc78381980"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1916, 1044},
WindowMargins->{{0, Automatic}, {4, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 246, 4, 68, "Section",ExpressionUUID->"fa5e9463-f3a0-4663-9a57-f1aae8bf0e2a"],
Cell[829, 28, 2000, 50, 262, "Input",ExpressionUUID->"cf1fe083-fe7f-43d4-8fd3-f9bba4a1dc84"],
Cell[2832, 80, 2626, 63, 377, "Input",ExpressionUUID->"ffb01604-be76-430c-bcd7-596b41202562"],
Cell[5461, 145, 1724, 38, 147, "Input",ExpressionUUID->"ebd69a85-9a96-47ce-8c96-88c49a6cf0bd"],
Cell[7188, 185, 4323, 96, 515, "Input",ExpressionUUID->"ee02c627-b7c1-43bd-afdd-547726884a72"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11548, 286, 162, 3, 68, "Section",ExpressionUUID->"9d61a7ff-3e44-4fbd-b301-a1bdfbd9305e"],
Cell[11713, 291, 2931, 79, 216, "Input",ExpressionUUID->"8e203c0b-a990-4b73-9070-5d52acc04fcc"],
Cell[14647, 372, 5793, 122, 607, "Input",ExpressionUUID->"a639225b-d52b-4a77-b2ea-de5395806f3c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20477, 499, 154, 3, 68, "Section",ExpressionUUID->"14fe7b53-3818-4c4b-a89c-7e6a9f07834d"],
Cell[20634, 504, 444, 10, 55, "Input",ExpressionUUID->"f679a5a9-66aa-4884-95f2-a7c0324693f9"],
Cell[21081, 516, 973, 18, 31, "Input",ExpressionUUID->"1e6df731-359c-4c01-aa6a-e0a4d67cdb5e"],
Cell[22057, 536, 565, 9, 31, "Input",ExpressionUUID->"ed5242f1-b95a-47c3-ae4a-8264be5686d4"],
Cell[22625, 547, 298, 6, 31, "Input",ExpressionUUID->"43436595-a5ba-4fd9-80f3-34ad8bb8823e"],
Cell[22926, 555, 305, 6, 31, "Input",ExpressionUUID->"2c98b153-1fb0-4069-817c-4b01c437dcbe"],
Cell[CellGroupData[{
Cell[23256, 565, 480, 8, 39, "Input",ExpressionUUID->"cd21246d-0b9e-4c19-86c9-b5f69fe44d48"],
Cell[23739, 575, 196, 2, 59, "Output",ExpressionUUID->"515631c9-1c47-489c-ad7f-ec28302a89d8"]
}, Open  ]],
Cell[23950, 580, 1342, 35, 104, "Input",ExpressionUUID->"4229400b-2d75-4f93-b834-19c07354606b"],
Cell[CellGroupData[{
Cell[25317, 619, 213, 4, 31, "Input",ExpressionUUID->"e88bee3d-425e-4d39-9f6b-112d08246750"],
Cell[25533, 625, 254, 6, 35, "Output",ExpressionUUID->"8b992c5a-55ce-4183-8816-302a8092c438"]
}, Open  ]],
Cell[25802, 634, 2578, 50, 170, "Input",ExpressionUUID->"bdad2440-4586-41aa-bffe-eac1c8a0e4c0"],
Cell[28383, 686, 1146, 27, 170, "Input",ExpressionUUID->"e59a61a7-819d-4ef2-92ef-57f9b364674f"],
Cell[29532, 715, 2678, 50, 216, "Input",ExpressionUUID->"7d8ba6c4-4e83-4fb5-8022-3837062f01b5"],
Cell[CellGroupData[{
Cell[32235, 769, 324, 6, 31, "Input",ExpressionUUID->"0b150d3b-0700-4051-b984-e9a13898ed14"],
Cell[32562, 777, 202, 2, 35, "Output",ExpressionUUID->"78bbd7dc-2f53-4578-a050-744530f9bc7b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32801, 784, 359, 6, 31, "Input",ExpressionUUID->"e394221c-ec3c-498c-8fb4-3bc6fe36b0db"],
Cell[33163, 792, 395, 6, 35, "Output",ExpressionUUID->"21647823-c969-4847-a860-1850d17f8eff"]
}, Open  ]],
Cell[33573, 801, 159, 3, 36, "Text",ExpressionUUID->"026c7671-b895-4d52-b466-0d1affcbd19d"],
Cell[33735, 806, 2479, 52, 216, "Input",ExpressionUUID->"3a2e6b25-f514-4aef-b1f9-81aac94de75d"],
Cell[CellGroupData[{
Cell[36239, 862, 486, 9, 31, "Input",ExpressionUUID->"8b795baa-3eb7-46e1-a664-62ead0fe0061"],
Cell[36728, 873, 342, 4, 35, "Output",ExpressionUUID->"dbdb820b-5eda-4264-b077-b79770344c74"]
}, Open  ]],
Cell[37085, 880, 1868, 39, 124, "Input",ExpressionUUID->"80f67321-161d-48b6-be08-85b5479031f3"],
Cell[CellGroupData[{
Cell[38978, 923, 587, 10, 31, "Input",ExpressionUUID->"4969bbad-8b51-4b36-a5f7-e9130c9dc1b4"],
Cell[39568, 935, 424, 7, 35, "Output",ExpressionUUID->"251432a5-82eb-4763-bf70-1c7c2a74466c"]
}, Open  ]],
Cell[40007, 945, 2044, 45, 192, "Input",ExpressionUUID->"919dc90b-da16-47fa-a2eb-92f000850036"],
Cell[42054, 992, 161, 3, 36, "Text",ExpressionUUID->"4cf97618-4861-4427-a289-d49a0639abfa"],
Cell[42218, 997, 986, 25, 101, "Input",ExpressionUUID->"f4cb808b-70cc-417e-babb-f2db6c1e7c2f"],
Cell[43207, 1024, 1826, 35, 124, "Input",ExpressionUUID->"30d678db-0c10-450b-a6e2-c080a502af21"],
Cell[CellGroupData[{
Cell[45058, 1063, 323, 7, 31, "Input",ExpressionUUID->"d7225777-6863-449e-bcec-e3bd5d5fe06d"],
Cell[45384, 1072, 204, 3, 35, "Output",ExpressionUUID->"50fdfdfd-3cd8-4e21-a68b-e902fe38bbcc"]
}, Open  ]],
Cell[45603, 1078, 1538, 28, 31, "Input",ExpressionUUID->"27e4b33d-d8ff-4da4-b372-d05da7e31c73"],
Cell[47144, 1108, 896, 23, 55, "Input",ExpressionUUID->"3b7ea660-8c11-4e99-b3e2-7c02260338e1"],
Cell[48043, 1133, 296, 6, 31, "Input",ExpressionUUID->"c7121959-69b9-45a9-b0a0-4b187a9ad113"],
Cell[48342, 1141, 179, 3, 31, "Input",ExpressionUUID->"fe9f040d-8251-496e-bf12-6361be7c2e8b"],
Cell[48524, 1146, 1308, 29, 78, "Input",ExpressionUUID->"669d5cfe-cefc-491f-a7bc-31aebde012ca"],
Cell[49835, 1177, 948, 19, 31, "Input",ExpressionUUID->"d3423956-3261-4515-95b7-b2f1a42057be"],
Cell[50786, 1198, 2088, 50, 166, "Input",ExpressionUUID->"033e801c-6247-4f1b-a871-3c27711a2cc7"],
Cell[CellGroupData[{
Cell[52899, 1252, 221, 4, 31, "Input",ExpressionUUID->"49a8f348-d8ba-493d-8cf9-78d0f30a2cca"],
Cell[53123, 1258, 524, 11, 23, "Message",ExpressionUUID->"263b5a62-894e-425c-9c6a-b7ea747c334d"],
Cell[53650, 1271, 1211, 19, 35, "Output",ExpressionUUID->"34a5923c-d86e-44c6-b8fa-698589618707"]
}, Open  ]],
Cell[54876, 1293, 654, 15, 78, "Input",ExpressionUUID->"3c79b155-deb1-4c5f-bd6b-d5cb74ecde81"],
Cell[55533, 1310, 695, 16, 55, "Input",ExpressionUUID->"c37999df-1cfb-48c6-8e66-bb91749427c0"],
Cell[56231, 1328, 410, 7, 31, "Input",ExpressionUUID->"c9961828-1154-4656-8d06-77ca425a6fda"],
Cell[56644, 1337, 212, 3, 31, "Input",ExpressionUUID->"1012af6c-994c-4089-bc68-3f564c561e8f"],
Cell[56859, 1342, 437, 9, 31, "Input",ExpressionUUID->"758482e8-4b4d-428a-82ef-3fad19fb3091"],
Cell[57299, 1353, 242, 5, 31, "Input",ExpressionUUID->"dc8a95ce-7526-4f34-a2c7-8f859397264e"],
Cell[57544, 1360, 512, 10, 31, "Input",ExpressionUUID->"6f234b90-b3b1-49e6-a02b-aa51e2bb663c"],
Cell[58059, 1372, 487, 12, 55, "Input",ExpressionUUID->"03136c75-adcf-4771-bd1a-db87122899a8"],
Cell[58549, 1386, 201, 4, 31, "Input",ExpressionUUID->"7f255c3a-9bc1-4866-aad4-fd2e85b48626"],
Cell[CellGroupData[{
Cell[58775, 1394, 283, 5, 55, "Input",ExpressionUUID->"fdbbadfe-7e6b-4033-8dd9-d145914da6f1"],
Cell[59061, 1401, 237, 4, 35, "Output",ExpressionUUID->"be578372-0d25-4d16-9c9d-856e7eb76efc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59335, 1410, 653, 14, 31, "Input",ExpressionUUID->"cb01f7c2-c90f-4247-b2ea-ced8713e2770"],
Cell[59991, 1426, 617, 14, 53, "Output",ExpressionUUID->"695389bf-c743-45cc-9c9c-83a32e6faaa1"]
}, Open  ]],
Cell[60623, 1443, 153, 3, 31, "Input",ExpressionUUID->"0c90c4a1-718c-446e-bc11-7bed10fd86f3"],
Cell[CellGroupData[{
Cell[60801, 1450, 348, 7, 31, "Input",ExpressionUUID->"eb2258ac-8093-40cf-a1de-648e0f8d0220"],
Cell[61152, 1459, 2858, 70, 82, "Output",ExpressionUUID->"83383f9f-38c3-4903-99c2-022b87f43b0d"]
}, Open  ]],
Cell[64025, 1532, 316, 6, 31, "Input",ExpressionUUID->"0a859f74-858c-4fe4-87f6-734f93e19499"],
Cell[CellGroupData[{
Cell[64366, 1542, 183, 4, 31, "Input",ExpressionUUID->"9b6d443e-5b4f-41b7-b4de-be5446422474"],
Cell[64552, 1548, 486, 11, 25, "Print",ExpressionUUID->"40794d2c-5087-46f8-981f-d5dd7bf0f9da"]
}, Open  ]],
Cell[65053, 1562, 291, 6, 31, "Input",ExpressionUUID->"d712dfcb-a8fd-455e-bbc3-422774292777"],
Cell[65347, 1570, 1850, 35, 124, "Input",ExpressionUUID->"97f983a5-fd89-4858-8f1d-9c5a61ea3ff1"],
Cell[67200, 1607, 1057, 27, 101, "Input",ExpressionUUID->"660c9d2f-186f-49ab-a311-425b9e1a001e"],
Cell[CellGroupData[{
Cell[68282, 1638, 171, 3, 46, "Subsubsection",ExpressionUUID->"c8d0863a-3de9-4fe9-b85d-787380a82a66"],
Cell[CellGroupData[{
Cell[68478, 1645, 356, 6, 31, "Input",ExpressionUUID->"2f47c0d3-ea77-4297-b450-b712bcd09da7"],
Cell[68837, 1653, 541, 13, 25, "Print",ExpressionUUID->"ad97046d-f6ea-4f03-9b03-dcd7b037cb8a"]
}, Open  ]],
Cell[69393, 1669, 175, 3, 31, "Input",ExpressionUUID->"f0a93ce0-bc7a-44fd-9067-ed192c5e5378"],
Cell[69571, 1674, 567, 13, 31, "Input",ExpressionUUID->"7740d38b-c4b2-4119-9977-de7e5804281b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70175, 1692, 160, 3, 46, "Subsubsection",ExpressionUUID->"5515b50c-3be7-4541-8174-675a1d8d093a"],
Cell[70338, 1697, 2416, 51, 454, "Input",ExpressionUUID->"a671ef6a-1e9d-4eeb-802a-73bc78381980"]
}, Open  ]]
}, Open  ]]
}
]
*)

