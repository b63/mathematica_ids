(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47200,       1101]
NotebookOptionsPosition[     45068,       1059]
NotebookOutlinePosition[     45402,       1074]
CellTagsIndexPosition[     45359,       1071]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["IDS Functions", "Section",
 CellChangeTimes->{{3.844810332434315*^9, 
  3.844810359034068*^9}},ExpressionUUID->"4498e5ef-0615-419a-a4b1-\
d782d057b57e"],

Cell[CellGroupData[{

Cell["Functions for Link Management", "Subsection",
 CellChangeTimes->{{3.844810654989958*^9, 
  3.8448106660599623`*^9}},ExpressionUUID->"c4dfaf84-2c43-4350-a874-\
89f86c93ea28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Attempt", " ", "to", " ", "connect", " ", "to", " ", "WSTP", " ", 
    "listening", " ", "under", " ", 
    RowBox[{"name", " ", "'"}], 
    RowBox[{
     StyleBox[
      RowBox[{"ueye", 
       StyleBox["n",
        FontWeight->"Bold",
        FontSlant->"Italic"]}]], "'"}], " ", "\[IndentingNewLine]", 
    RowBox[{"Example", ":", " ", 
     RowBox[{"link", " ", 
      RowBox[{"named", " ", "'"}], 
      RowBox[{"ueye1", "'"}], " ", "should", " ", "be", " ", "waiting", " ", 
      "for", " ", "connection", " ", "if", " ", "n", " ", "is", " ", "1.", 
      "\[IndentingNewLine]", "Function", " ", "Aborts", " ", "if", " ", 
      "activation", " ", "does", " ", "not", " ", "occur", " ", "within", " ",
       "5", " ", 
      RowBox[{"seconds", "."}]}]}]}], " ", "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"EstablishLink", "[", "n_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"link", " ", "=", " ", 
         RowBox[{"LinkConnect", "[", 
          RowBox[{"\"\<ueye\>\"", "<>", 
           RowBox[{"ToString", "[", "n", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"TimeConstrained", "[", 
         RowBox[{
          RowBox[{"LinkActivate", "[", "link", "]"}], ",", "5"}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Closes", " ", "all", " ", "links", " ", "with", " ", "names", " ", 
     "that", " ", "start", " ", "with", " ", "ueye", "*", 
     RowBox[{".", "\[IndentingNewLine]", 
      RowBox[{"Note", ":", " ", 
       RowBox[{
       "ALWAYS", " ", "CLOSE", " ", "LINK", " ", "AFTER", " ", "ONE", " ", 
        "SIDE", " ", "CLOSES", " ", "THE", " ", 
        RowBox[{
         RowBox[{"LINK", "/", "AND"}], "/", "OR"}], " ", "CRASHES"}]}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CloseLink", "[", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"LinkClose", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"Links", "[", "\"\<ueye*\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Links", "[", "\"\<ueye*\>\"", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Set", " ", "some", " ", "parameter", " ", "in", " ", "the", " ", 
      "Camera"}], ",", " ", 
     RowBox[{
     "only", " ", "exposure", " ", "and", " ", "gain", " ", "supported", " ", 
      "atm"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SetCameraProperty", "::", "notsupp"}], " ", "=", " ", 
     "\"\<Property `1` not supported\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SetCameraProperty", "[", 
      RowBox[{"name_", ",", " ", "value_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<exposure\>\"", ",", " ", "\"\<gain\>\""}], "}"}], 
             ",", " ", "name"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"SetProperty", "::", "notsupp"}], ",", " ", "name"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Check", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"LinkWrite", "[", 
             RowBox[{"link", ",", " ", 
              RowBox[{"ReturnExpressionPacket", "[", 
               RowBox[{"{", 
                RowBox[{"name", ",", " ", "value"}], "}"}], "]"}]}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Abort", "[", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
         "]"}], " ", ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Crop", " ", "the", " ", "image", " ", "before", " ", "sending", " ", 
      "to", " ", "Mathematica"}], " ", "-", " ", 
     RowBox[{
     "Mathematica", " ", "lags", " ", "real", " ", "hard", " ", "if", " ", 
      "image", " ", "is", " ", "big"}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SetImageDimensions", "::", "notsupp"}], " ", "=", " ", 
     "\"\<Property `1` not supported\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SetImageDimensions", "[", 
      RowBox[{"width_", ",", " ", "height_", ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"{", 
         RowBox[{"TopLeft", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "w", ",", "h"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", " ", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "TopLeft", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"y", " ", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "TopLeft", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"w", " ", "=", " ", 
         RowBox[{"IntegerPart", "[", "width", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"h", " ", "=", " ", 
         RowBox[{"IntegerPart", "[", "height", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Check", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LinkWrite", "[", 
           RowBox[{"link", ",", " ", 
            RowBox[{"ReturnExpressionPacket", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<imgcrop\>\"", ",", " ", "x", ",", " ", "y", ",", " ", "w", 
               ",", " ", "h"}], "}"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Abort", "[", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Send", " ", "an", " ", "Image", " ", "to", " ", "be", " ", "displayed", 
      " ", "on", " ", "the", " ", "screen"}], ",", " ", 
     RowBox[{
     "aborts", " ", "if", " ", "something", " ", "goes", " ", "wrong"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SendImage", "::", "dim"}], " ", "=", " ", 
     "\"\<must be of pixel 2d array with 1 or 3 channels\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SendImage", "[", "image_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bytes", ",", "n", ",", "dim"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ImageQ", "[", "image", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"bytes", " ", "=", " ", 
           RowBox[{"ImageData", "[", 
            RowBox[{"image", ",", " ", "\"\<Byte\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"bytes", " ", "=", " ", "image"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"dim", " ", "=", " ", 
         RowBox[{"Dimensions", "@", "bytes"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"Length", "@", "dim"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", " ", 
            RowBox[{"bytes", "=", " ", 
             RowBox[{"ArrayReshape", "[", 
              RowBox[{"bytes", ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"dim", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"dim", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}]}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"bytes", "=", 
             RowBox[{"bytes", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", ";;", ",", 
                RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"n", " ", "\[Equal]", " ", "2"}], " ", "||", " ", 
           RowBox[{"n", " ", "\[Equal]", " ", "3"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Check", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"LinkWrite", "[", 
              RowBox[{"link", ",", " ", 
               RowBox[{"ReturnExpressionPacket", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<send\>\"", ",", " ", "bytes"}], "}"}], "]"}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Pause", "[", "0.5", "]"}]}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "pause", " ", "for", " ", "a", " ", "litle", " ", "bit"}], ",", 
              " ", 
              RowBox[{
              "immediately", " ", "reading", " ", "when", " ", "other", " ", 
               "program", " ", 
               RowBox[{"isn", "'"}], "t", " ", "ready", " ", "seems", " ", 
               "to", " ", "let", " ", "all", " ", "hell", " ", "break", " ", 
               "lose", " ", "and", " ", "kernel", " ", "needs", " ", "to", 
               " ", "be", " ", "restarted"}]}], " ", "*)"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Abort", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Message", "[", 
           RowBox[{"SendImage", "::", "dim"}], "]"}]}], "\[IndentingNewLine]",
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Attempts", " ", "to", " ", "get", " ", "the", " ", "image", " ", "from",
       " ", "the", " ", "Camera"}], ",", " ", 
     RowBox[{
     "aborts", " ", "if", " ", "an", " ", "error", " ", "occurs", " ", 
      "while", " ", "reading", " ", "from", " ", 
      RowBox[{"link", ".", "\[IndentingNewLine]", "If"}], " ", "no", " ", 
      "data", " ", "is", " ", "avaiable", " ", "withint", " ", "TimeOut"}], 
     ",", " ", 
     RowBox[{"returns", " ", 
      RowBox[{"None", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GetImage", "::", "writetimeout"}], "=", 
     "\"\<Timeout when trying to write to link\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GetImage", "::", "readtimeout"}], "=", 
     "\"\<Timeout when trying to read from link\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GetImage", "[", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"{", 
        RowBox[{"TimeOut", "\[Rule]", " ", "5"}], "}"}], "]"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rt", "=", "None"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Check", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "no", " ", "clue", " ", "by", " ", "TimeConstrained", " ", 
            RowBox[{"doesn", "'"}], "t", " ", "work", " ", "here"}], "..."}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TimeConstrained", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"LinkWrite", "[", 
             RowBox[{"link", ",", 
              RowBox[{"ReturnExpressionPacket", "[", 
               RowBox[{"{", "\"\<get\>\"", "}"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"OptionValue", "[", "TimeOut", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Message", "[", 
             RowBox[{"GetImage", "::", "writetimeout"}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Abort", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"LinkReadyQ", "[", 
           RowBox[{"link", ",", 
            RowBox[{"OptionValue", "[", "TimeOut", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rt", "=", 
            RowBox[{"Check", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"TimeConstrained", "[", 
               RowBox[{
                RowBox[{"LinkRead", "[", "link", "]"}], ",", 
                RowBox[{"OptionValue", "[", "TimeOut", "]"}], ",", 
                RowBox[{"Message", "[", 
                 RowBox[{"GetImage", "::", "readtimeout"}], "]"}]}], "]"}], 
              ",", "\[IndentingNewLine]", " ", 
              RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"bytes", "=", "rt"}], ";", "\[IndentingNewLine]", 
           RowBox[{"PrintTemporary", "[", 
            RowBox[{"\"\<converting \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Dimensions", "@", "rt"}], "]"}], "<>", 
             "\"\< image ...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Image", "[", 
            RowBox[{"rt", ",", " ", "\"\<Byte\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", "None"}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8447408747136593`*^9, 3.8447409776734333`*^9}, {
   3.844741067200389*^9, 3.844741240029139*^9}, {3.8447414278345137`*^9, 
   3.844741522388459*^9}, {3.8447415653796387`*^9, 3.844741768214747*^9}, {
   3.8447418279761744`*^9, 3.84474187721706*^9}, {3.844761828322052*^9, 
   3.844761859485458*^9}, {3.844810275150283*^9, 3.84481027966434*^9}, {
   3.8448127680821495`*^9, 3.8448127690321445`*^9}, {3.8448127997621365`*^9, 
   3.8448128297021475`*^9}, {3.844812870042143*^9, 3.84481287622215*^9}, {
   3.844813121137395*^9, 3.844813125637393*^9}, {3.844816482845657*^9, 
   3.844816522655655*^9}, {3.844817651066927*^9, 3.8448176549969397`*^9}, {
   3.8448191354462986`*^9, 3.8448193951962996`*^9}, 3.8448567357746363`*^9, {
   3.844856769564743*^9, 3.8448567785556498`*^9}, {3.844856869163273*^9, 
   3.844857102551201*^9}, {3.8449072414793425`*^9, 3.8449072453230767`*^9}, {
   3.844907302710535*^9, 3.8449074128042946`*^9}, {3.8455831370100517`*^9, 
   3.8455833708448067`*^9}, {3.845584662385571*^9, 3.8455846934034157`*^9}, {
   3.845669901144256*^9, 3.845669901521392*^9}, {3.8456699499023314`*^9, 
   3.8456699545965023`*^9}, {3.846202240195815*^9, 3.846202251752707*^9}, {
   3.84620235613721*^9, 3.846202376332158*^9}, {3.846202504905114*^9, 
   3.846202524489572*^9}, {3.846202574114134*^9, 3.846202660477922*^9}, {
   3.846202723735569*^9, 3.846202774617688*^9}, {3.846203027183979*^9, 
   3.8462030369114437`*^9}, {3.846203444121768*^9, 3.846203524989108*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"b754dcd4-23db-4d47-9ec4-43e5e5b071df"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Phase Correction", "Section",
 CellChangeTimes->{{3.846203808769896*^9, 
  3.846203817022039*^9}},ExpressionUUID->"b16162da-563c-4a90-abc1-\
472c54479c57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"blaze", " ", "'"}], 
    RowBox[{"blocks", "'"}], " ", "of", " ", "the", " ", "image"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BlazedMode", "[", 
     RowBox[{
     "rowt_", ",", " ", "colt_", ",", " ", "offset_", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"OptionsPattern", "[", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Width", "\[Rule]", " ", "500"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Height", "\[Rule]", " ", "500"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Blocks", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{"5", ",", " ", "5"}], "}"}]}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"BlazeAngle", "\[Rule]", " ", 
          RowBox[{"45", " ", "Degree"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ReferenceBlock", " ", "\[Rule]", " ", "\"\<Center\>\""}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"UseImage", "\[Rule]", " ", "None"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frequency", "\[Rule]", " ", 
          RowBox[{"1", "/", "10"}]}]}], "\[IndentingNewLine]", "}"}], "]"}]}],
      "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Check", "[", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"img", ",", " ", 
          RowBox[{"w", "=", 
           RowBox[{"OptionValue", "[", "Width", "]"}]}], ",", " ", 
          RowBox[{"h", "=", 
           RowBox[{"OptionValue", "[", "Height", "]"}]}], ",", "xr", ",", 
          "yr", ",", "\[IndentingNewLine]", " ", "nw", ",", " ", "nh", ",", 
          " ", 
          RowBox[{"angle", "=", 
           RowBox[{"OptionValue", "[", "BlazeAngle", "]"}]}], ",", "bw", ",", 
          "bh", ",", " ", 
          RowBox[{"rb", "=", 
           RowBox[{"OptionValue", "[", "ReferenceBlock", "]"}]}], ",", "rxi", 
          ",", " ", "ryi", ",", "rxr", ",", "ryr", ",", "rr", ",", "cr", ",", 
          
          RowBox[{"frq", "=", 
           RowBox[{"OptionValue", "@", "Frequency"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "@", "UseImage"}], " ", "===", "None"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"img", " ", "=", " ", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", " ", 
              RowBox[{"{", 
               RowBox[{"h", ",", " ", "w"}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"img", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ImageQ", "@", 
                RowBox[{"OptionValue", "@", "UseImage"}]}], ",", 
               RowBox[{"ImageData", "@", 
                RowBox[{"OptionValue", "@", "UseImage"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"OptionValue", "@", "UseImage"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"h", ",", "w"}], "}"}], "=", 
             RowBox[{"Dimensions", "@", "img"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ListQ", "@", 
            RowBox[{"OptionValue", "@", "Blocks"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"nw", ",", "nh"}], "}"}], "=", 
            RowBox[{"OptionValue", "@", "Blocks"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nw", " ", "=", " ", 
             RowBox[{"OptionValue", "@", "Blocks"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"nh", "=", "nw"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"bw", ",", "bh"}], "}"}], "=", 
          RowBox[{"Floor", "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"w", "/", "nw"}], ",", " ", 
             RowBox[{"h", "/", "nh"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xr", "[", "i_", "]"}], ":=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bw", "*", "i"}], "+", "1"}], ")"}], ";;", 
           RowBox[{"(", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "\[Equal]", 
               RowBox[{"nw", "-", "1"}]}], ",", "w", ",", 
              RowBox[{"bw", "*", 
               RowBox[{"(", 
                RowBox[{"i", "+", "1"}], ")"}]}]}], "]"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"yr", "[", "i_", "]"}], ":=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bh", "*", "i"}], "+", "1"}], ")"}], ";;", 
           RowBox[{"(", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "\[Equal]", 
               RowBox[{"nh", "-", "1"}]}], ",", "w", ",", 
              RowBox[{"bh", "*", 
               RowBox[{"(", 
                RowBox[{"i", "+", "1"}], ")"}]}]}], "]"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"rb", " ", "=!=", " ", "None"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"ListQ", "@", "rb"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ryi", ",", "rxi"}], "}"}], "=", 
               RowBox[{"Floor", "/@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"nh", "-", "1"}], ",", 
                    RowBox[{"nw", "-", "1"}]}], "}"}], "/", "2"}], ")"}]}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ryi", ",", "rxi"}], "}"}], "=", "rb"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"rxr", "=", 
             RowBox[{"xr", "[", "rxi", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"ryr", "=", 
             RowBox[{"yr", "[", "ryi", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"img", "[", 
              RowBox[{"[", 
               RowBox[{"ryr", ",", "rxr"}], "]"}], "]"}], "=", 
             RowBox[{"LG`BlazeImage", "[", 
              RowBox[{
               RowBox[{"img", "[", 
                RowBox[{"[", 
                 RowBox[{"ryr", ",", "rxr"}], "]"}], "]"}], ",", "angle", ",", 
               RowBox[{"Raw", "\[Rule]", " ", "True"}], ",", " ", 
               RowBox[{"Frequency", "\[Rule]", " ", "frq"}], ",", " ", 
               RowBox[{"PhaseOffset", "\[Rule]", " ", "0"}]}], "]"}]}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"rr", ",", "cr"}], "}"}], "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"yr", "@", "rowt"}], ",", 
            RowBox[{"xr", "@", "colt"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"img", "[", 
           RowBox[{"[", 
            RowBox[{"rr", ",", "cr"}], "]"}], "]"}], "=", 
          RowBox[{"LG`BlazeImage", "[", 
           RowBox[{
            RowBox[{"img", "[", 
             RowBox[{"[", 
              RowBox[{"rr", ",", "cr"}], "]"}], "]"}], ",", "angle", ",", 
            RowBox[{"Raw", "\[Rule]", " ", "True"}], ",", " ", 
            RowBox[{"Frequency", "\[Rule]", " ", "frq"}], ",", " ", 
            RowBox[{"PhaseOffset", "\[Rule]", " ", "offset"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Image", "[", "img", "]"}]}]}], "\[IndentingNewLine]", "]"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ7fTyhQXvijeObx4uSQTRyctvp4Lou9Pz8kE0W/+n
JSB6jn/YWhC9orh7K4g+qr1vG4iWCPixG0T/+ffnIojuU86/BqJjD4XfA9FW
FcZPQfSCE0HPQPSqYp3PIPqIWakwH5B+kbpFAkSzXe6SA9Fl23epg2gdHydL
EP1t9jRPEC3EssEbRB/h4gsB0Y6ft2SAaAu9wAIwvetJJYjWkHlYC6LTfnfM
AosbKywC0Z9LDoLpFP9LG0D0tbKkHSB6QpHnKRC9zL3yPIjWMjt0C0T/YDS/
A6JP/cl8BaJnJMwC01P7crn4gbScOjMviI7RfyUAovulQ4XA9ENRLxA9Sdcf
TPtoPYkF0Wd2lMaDaABWXLTX
  "],
 CellLabel->"In[64]:=",ExpressionUUID->"ca61e84a-d11e-4ed6-be56-450c09accd1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "to", " ", "pick", " ", "a", " ", "pixel", " ", "as", " ", "the", " ", 
    "intensity", " ", "probe"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pixelpos", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PixelChooser", "[", 
      RowBox[{"image_", ",", "x_", ",", "y_", ",", "scale_", ",", "hbs_"}], 
      "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Check", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Module", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "i", ",", "bx", ",", " ", "by", ",", "bxs", ",", "bys", ",", "w", 
           ",", "h", ",", "sx", ",", "ex", ",", "sy", ",", "ey", ",", "data", 
           ",", "subimg", ",", "subimgs", ",", "offsetxs", ",", "border", ",",
            "offsetys", ",", "offsetxe", ",", "offsetye", ",", "scaledsubimg",
            ",", "smallsubimg"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"data", "=", 
           RowBox[{"ImageData", "@", "image"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h", ",", "w"}], "}"}], "=", 
           RowBox[{"Dimensions", "@", "data"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"pixelpos", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"h", "+", "1", "-", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Floor", "[", "y", "]"}], "+", "1"}], ",", "1"}], 
                 "]"}], ",", "h"}], "]"}]}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Floor", "[", "x", "]"}], "+", "1"}], ",", "1"}], 
                "]"}], ",", "w"}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"by", ",", "bx"}], "}"}], "=", 
           RowBox[{"pixelpos", "-", "hbs"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"subimgs", "=", 
           RowBox[{"scale", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "*", "hbs"}], "+", "1"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"subimg", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"subimgs", ",", "subimgs"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"sx", ",", "sy"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"bx", ",", "1"}], "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{"by", ",", "1"}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ex", ",", "ey"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"bx", "+", 
                RowBox[{"2", "*", "hbs"}]}], ",", "w"}], "]"}], ",", " ", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"by", "+", 
                RowBox[{"2", "*", "hbs"}]}], ",", "h"}], "]"}]}], "}"}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"smallsubimg", "=", 
           RowBox[{"ImageTake", "[", 
            RowBox[{"image", ",", 
             RowBox[{"{", 
              RowBox[{"sy", ",", "ey"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"sx", ",", "ex"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"scaledsubimg", "=", 
           RowBox[{"ImageResize", "[", 
            RowBox[{"smallsubimg", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Scaled", "[", "scale", "]"}], ",", 
               RowBox[{"Scaled", "[", "scale", "]"}]}], "}"}], ",", 
             RowBox[{"Resampling", "\[Rule]", " ", "\"\<Constant\>\""}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"offsetxs", ",", "offsetys"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"bx", " ", "<", " ", "1"}], ",", " ", 
               RowBox[{
                RowBox[{"scale", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "bx"}], "+", "1"}], ")"}]}], "+", "1"}], ",", 
               " ", "1"}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"by", "<", " ", "1"}], ",", " ", 
               RowBox[{
                RowBox[{"scale", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "by"}], "+", "1"}], ")"}]}], "+", "1"}], ",", 
               " ", "1"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"offsetxe", ",", "offsetye"}], "}"}], "=", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"bx", "+", 
                 RowBox[{"2", "*", "hbs"}]}], " ", ">", "w"}], ",", 
               RowBox[{"subimgs", "+", 
                RowBox[{"scale", "*", 
                 RowBox[{"(", " ", 
                  RowBox[{"w", "-", 
                   RowBox[{"(", 
                    RowBox[{"bx", "+", 
                    RowBox[{"2", "*", "hbs"}]}], " ", ")"}]}], ")"}]}]}], ",",
                " ", "subimgs"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"by", "+", 
                 RowBox[{"2", "*", "hbs"}]}], ">", "h"}], ",", " ", 
               RowBox[{"subimgs", "+", 
                RowBox[{"scale", "*", 
                 RowBox[{"(", 
                  RowBox[{"h", "-", 
                   RowBox[{"(", 
                    RowBox[{"by", "+", 
                    RowBox[{"2", "*", "hbs"}]}], ")"}]}], ")"}]}]}], ",", " ",
                "subimgs"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"subimg", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"offsetys", ";;", "offsetye"}], ",", 
              RowBox[{"offsetxs", ";;", "offsetxe"}]}], "]"}], "]"}], "=", 
           RowBox[{"ImageData", "@", "scaledsubimg"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"border", "=", 
           RowBox[{"scale", "*", 
            RowBox[{"(", 
             RowBox[{"hbs", "+", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Row", "[", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Show", "[", 
              RowBox[{"image", ",", " ", 
               RowBox[{"ImageSize", "\[Rule]", " ", 
                RowBox[{"UpTo", "[", "500", "]"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Spacer", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Show", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Image", "@", "subimg"}], ",", " ", 
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{"Red", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"border", ",", "border"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"border", "+", "scale"}], ",", "border"}], "}"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"border", "+", "scale"}], ",", 
                    RowBox[{"border", "+", "scale"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"border", ",", 
                    RowBox[{"border", "+", "scale"}]}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"border", ",", "border"}], "}"}]}], "}"}], "-", 
                    "scale"}], "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]",
               "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.846232240280223*^9, 3.846232436180352*^9}, {
   3.846232469430417*^9, 3.846232558152954*^9}, {3.846232705875211*^9, 
   3.846232727485682*^9}, {3.846232767715208*^9, 3.846232770967208*^9}, {
   3.8462329139122887`*^9, 3.8462331462934113`*^9}, {3.846233195804174*^9, 
   3.84623325484459*^9}, {3.8462334206883783`*^9, 3.8462335317845163`*^9}, {
   3.846233571247985*^9, 3.846233687741645*^9}, {3.8462337757289267`*^9, 
   3.846233816765891*^9}, {3.846233933094222*^9, 3.846233941272691*^9}, {
   3.846233988530085*^9, 3.8462339935714197`*^9}, {3.8462340452194643`*^9, 
   3.8462340477557573`*^9}, {3.846234102855098*^9, 3.84623415273976*^9}, {
   3.846234209230357*^9, 3.846234215320656*^9}, {3.846234252180496*^9, 
   3.846234255824349*^9}, {3.846234355062549*^9, 3.84623449297195*^9}, {
   3.846234533157729*^9, 3.846234759149246*^9}, {3.846234823231481*^9, 
   3.846234895101245*^9}, {3.846234925950276*^9, 3.846234958165625*^9}, {
   3.846235074595064*^9, 3.846235113143075*^9}, {3.846235190327628*^9, 
   3.8462352787879877`*^9}, {3.846235335218339*^9, 3.846235451112706*^9}, {
   3.8462354825971413`*^9, 3.846235491774253*^9}, {3.846235521832078*^9, 
   3.846235526906828*^9}, {3.846235614810666*^9, 3.846235676628406*^9}, {
   3.846235759988246*^9, 3.846235767563167*^9}, {3.846235915788632*^9, 
   3.846235982877489*^9}, {3.846236044583171*^9, 3.846236049433895*^9}, {
   3.846236175896016*^9, 3.846236180866626*^9}, {3.846236284083127*^9, 
   3.8462363217045794`*^9}, {3.8462365287679663`*^9, 
   3.8462365691350517`*^9}, {3.846236793392829*^9, 3.846236848724641*^9}, {
   3.846236890925136*^9, 3.846236896105076*^9}, {3.846237041895562*^9, 
   3.846237044458647*^9}, {3.846237500084347*^9, 3.846237515534346*^9}, {
   3.846237558673396*^9, 3.846237581374395*^9}, {3.8462376351559134`*^9, 
   3.8462376378548317`*^9}, {3.8462376808578987`*^9, 
   3.8462377332640867`*^9}, {3.8462377679033413`*^9, 3.846237801824218*^9}, {
   3.846237840297373*^9, 3.84623793087221*^9}, 3.846238748919992*^9, {
   3.846238783584695*^9, 3.8462388018411417`*^9}, {3.846238867033614*^9, 
   3.846238902747745*^9}, {3.846239146487076*^9, 3.84623917376346*^9}, {
   3.846239229998377*^9, 3.846239231489089*^9}, {3.846239307886572*^9, 
   3.846239355450987*^9}, {3.8462394053159943`*^9, 3.846239415766697*^9}, {
   3.846239452217964*^9, 3.8462395130667057`*^9}, {3.84623963599088*^9, 
   3.846239764152073*^9}, {3.8462398326647463`*^9, 3.846239840240982*^9}, {
   3.846240040636057*^9, 3.846240052447118*^9}, 3.846240122187974*^9, {
   3.846240190547296*^9, 3.8462402237882137`*^9}, {3.846240254809742*^9, 
   3.8462402900569077`*^9}, {3.8462403265904007`*^9, 3.846240418773162*^9}, {
   3.846240456047431*^9, 3.8462404597226963`*^9}, {3.8462405072877617`*^9, 
   3.8462405098631363`*^9}, {3.846240810087061*^9, 3.8462408609075413`*^9}, {
   3.846241414501772*^9, 3.846241417278001*^9}, {3.846241493447769*^9, 
   3.846241496238017*^9}, {3.846241740208233*^9, 3.846241871176742*^9}, {
   3.846241906462893*^9, 3.846241917376596*^9}, {3.846241954508072*^9, 
   3.846241989696474*^9}, {3.846242022345345*^9, 3.846242031003832*^9}, {
   3.8462420701228523`*^9, 3.846242079938593*^9}, {3.846242585910356*^9, 
   3.8462426004612303`*^9}},ExpressionUUID->"ed0ae468-cd11-4e49-ae4e-\
4130e0deb825"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ManipulatePixelChooser", "[", "image_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pixelpos", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Chosen pixel (row, col): \>\"", ",", 
        RowBox[{"Dynamic", "[", "pixelpos", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PixelChooser", "[", 
         RowBox[{"image", ",", 
          RowBox[{"p", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"p", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "7", ",", "10"}], " ", "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "  ", "Locator"}], 
         "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.846240975022794*^9, 3.846240975046427*^9}, {
  3.846242358977919*^9, 3.8462424357121487`*^9}, {3.846242470975103*^9, 
  3.8462424763942423`*^9}, {3.846242506986209*^9, 3.8462425374230623`*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"16c5d56f-f2a6-4fe4-983a-57f5ea6bd248"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Program", "Section",
 CellChangeTimes->{{3.844812067143608*^9, 
  3.8448120691335983`*^9}},ExpressionUUID->"14fe7b53-3818-4c4b-a89c-\
7e6a9f07834d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"*", " ", 
   RowBox[{"EstablishLink", "[", "0", "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"start", " ", "link"}], ",", " ", 
     RowBox[{"make", " ", "sure", " ", "ueye_link", " ", 
      RowBox[{"is", " ", "'"}], "waiting", " ", "for", " ", 
      RowBox[{"connection", "'"}]}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8448120743536024`*^9, 3.8448120788936095`*^9}, {
   3.844812747042141*^9, 3.8448127479521427`*^9}, {3.844813029742141*^9, 
   3.844813030422144*^9}, {3.8448163574657917`*^9, 3.844816358055791*^9}, {
   3.8448194345662947`*^9, 3.844819458166295*^9}, {3.8448571425476294`*^9, 
   3.8448571426432943`*^9}, {3.845583108261401*^9, 3.845583108450591*^9}, {
   3.845584551266966*^9, 3.845584552577474*^9}, 3.8456700732748957`*^9, {
   3.845670156211924*^9, 3.845670156390291*^9}, {3.845818730480789*^9, 
   3.845818732348241*^9}},ExpressionUUID->"1e6df731-359c-4c01-aa6a-\
e0a4d67cdb5e"],

Cell[BoxData[
 RowBox[{"EstablishLink", "[", "0", "]"}]], "Input",
 CellChangeTimes->{{3.846201278840493*^9, 3.846201281284244*^9}, {
  3.8462020537536507`*^9, 3.8462020540103607`*^9}, {3.846202286468583*^9, 
  3.846202286598235*^9}, {3.846202665787912*^9, 3.846202665867302*^9}, {
  3.8462031240393476`*^9, 3.846203124195291*^9}, {3.846203574666224*^9, 
  3.8462035748753977`*^9}},ExpressionUUID->"ed5242f1-b95a-47c3-ae4a-\
8264be5686d4"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\</home/hfl/ldata/edu/guoy_phase/laguerre/LG.wl\>\""}]], "Input",
 CellChangeTimes->{{3.845669509841515*^9, 3.8456695261433907`*^9}, {
  3.845670049359408*^9, 3.8456700530160418`*^9}, {3.845818149671233*^9, 
  3.8458182101458073`*^9}, {3.8462067053223333`*^9, 3.846206708544455*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"c37999df-1cfb-48c6-8e66-bb91749427c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StartLG", "[", 
   RowBox[{
   "\"\</home/hfl/ldata/edu/guoy_phase/laguerre\>\"", ",", " ", 
    "\"\<bin/lg\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.846206751047542*^9, 3.846206784676424*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"c9961828-1154-4656-8d06-77ca425a6fda"],

Cell[BoxData[
 RowBox[{"BlazedMode", "[", 
  RowBox[{"3", ",", "4", ",", "1", ",", 
   RowBox[{"Width", "\[Rule]", " ", "780"}], ",", " ", 
   RowBox[{"Height", "\[Rule]", " ", "480"}], ",", 
   RowBox[{"Blocks", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{"16", ",", "9"}], "}"}]}], ",", " ", 
   RowBox[{"Frequency", "\[Rule]", " ", 
    RowBox[{"1", "/", "30"}]}], ",", " ", 
   RowBox[{"UseImage", "\[Rule]", " ", "img"}]}], "]"}]], "Input",ExpressionUU\
ID->"97f983a5-fd89-4858-8f1d-9c5a61ea3ff1"],

Cell[CellGroupData[{

Cell["Pick Intensity Probe", "Subsubsection",
 CellChangeTimes->{{3.846242258913486*^9, 
  3.846242269818902*^9}},ExpressionUUID->"c8d0863a-3de9-4fe9-b85d-\
787380a82a66"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ManipulatePixelChooser", "[", "img", "]"}]], "Input",
 CellChangeTimes->{{3.8462422890070343`*^9, 3.846242311793518*^9}, 
   3.846242397003724*^9, {3.8462424462785683`*^9, 3.846242450689423*^9}, {
   3.8462424817570057`*^9, 3.8462424833164473`*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"2f47c0d3-ea77-4297-b450-b712bcd09da7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Chosen pixel (row, col): \"\>", "\[InvisibleSpace]", 
   DynamicBox[ToBoxes[$CellContext`pixelpos, StandardForm],
    ImageSizeCache->{75., {3., 9.}}]}],
  SequenceForm["Chosen pixel (row, col): ", 
   Dynamic[$CellContext`pixelpos]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.846242312579804*^9, 3.8462424512406693`*^9, {3.8462424838799686`*^9, 
   3.846242541110156*^9}},
 CellLabel->
  "During evaluation of \
In[185]:=",ExpressionUUID->"ad97046d-f6ea-4f03-9b03-dcd7b037cb8a"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.844857300608103*^9, 3.844857300621572*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"f0a93ce0-bc7a-44fd-9067-ed192c5e5378"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"*", " ", 
   RowBox[{"CloseLink", "[", "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"close", " ", "link", " ", "and", " ", "re"}], "-", 
     RowBox[{
     "run", " ", "EstablishLink", " ", "if", " ", "something", " ", "goes", 
      " ", "wrong"}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8448126745521493`*^9, 3.844812683212143*^9}, {
  3.8448194624663143`*^9, 3.8448194797363005`*^9}, {3.8458187365126653`*^9, 
  3.8458187370752974`*^9}},ExpressionUUID->"7740d38b-c4b2-4119-9977-\
de7e5804281b"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1237, 1038},
WindowMargins->{{7, Automatic}, {7, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 158, 3, 68, "Section",ExpressionUUID->"4498e5ef-0615-419a-a4b1-d782d057b57e"],
Cell[CellGroupData[{
Cell[763, 29, 179, 3, 55, "Subsection",ExpressionUUID->"c4dfaf84-2c43-4350-a874-89f86c93ea28"],
Cell[945, 34, 16133, 369, 2171, "Input",ExpressionUUID->"b754dcd4-23db-4d47-9ec4-43e5e5b071df"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17127, 409, 161, 3, 68, "Section",ExpressionUUID->"b16162da-563c-4a90-abc1-472c54479c57"],
Cell[17291, 414, 9031, 216, 1171, "Input",ExpressionUUID->"ca61e84a-d11e-4ed6-be56-450c09accd1d"],
Cell[26325, 632, 12478, 265, 1067, "Input",ExpressionUUID->"ed0ae468-cd11-4e49-ae4e-4130e0deb825"],
Cell[38806, 899, 1513, 36, 216, InheritFromParent,ExpressionUUID->"16c5d56f-f2a6-4fe4-983a-57f5ea6bd248"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40356, 940, 154, 3, 68, "Section",ExpressionUUID->"14fe7b53-3818-4c4b-a89c-7e6a9f07834d"],
Cell[40513, 945, 973, 18, 31, "Input",ExpressionUUID->"1e6df731-359c-4c01-aa6a-e0a4d67cdb5e"],
Cell[41489, 965, 439, 7, 31, "Input",ExpressionUUID->"ed5242f1-b95a-47c3-ae4a-8264be5686d4"],
Cell[41931, 974, 397, 6, 31, "Input",ExpressionUUID->"c37999df-1cfb-48c6-8e66-bb91749427c0"],
Cell[42331, 982, 320, 7, 31, "Input",ExpressionUUID->"c9961828-1154-4656-8d06-77ca425a6fda"],
Cell[42654, 991, 506, 11, 31, "Input",ExpressionUUID->"97f983a5-fd89-4858-8f1d-9c5a61ea3ff1"],
Cell[CellGroupData[{
Cell[43185, 1006, 171, 3, 46, "Subsubsection",ExpressionUUID->"c8d0863a-3de9-4fe9-b85d-787380a82a66"],
Cell[CellGroupData[{
Cell[43381, 1013, 356, 6, 31, "Input",ExpressionUUID->"2f47c0d3-ea77-4297-b450-b712bcd09da7"],
Cell[43740, 1021, 540, 13, 25, "Print",ExpressionUUID->"ad97046d-f6ea-4f03-9b03-dcd7b037cb8a"]
}, Open  ]],
Cell[44295, 1037, 175, 3, 31, "Input",ExpressionUUID->"f0a93ce0-bc7a-44fd-9067-ed192c5e5378"],
Cell[44473, 1042, 567, 13, 31, "Input",ExpressionUUID->"7740d38b-c4b2-4119-9977-de7e5804281b"]
}, Open  ]]
}, Open  ]]
}
]
*)

